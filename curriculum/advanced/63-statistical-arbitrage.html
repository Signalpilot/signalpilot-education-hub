<!doctype html>
<html lang="en" dir="ltr" data-theme="dark">
<head>
  <link rel="manifest" href="/manifest.json">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/icon-180x180.png">
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=5, viewport-fit=cover"/>
  <!-- AGGRESSIVE CACHE PREVENTION -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate, max-age=0"/>
  <meta http-equiv="Pragma" content="no-cache"/>
  <meta http-equiv="Expires" content="0"/>
  <title>Statistical Arbitrage: Quantitative Mean Reversion ‚Äî Signal Pilot Education</title>
  <meta name="description" content="Statistical Arbitrage: Quantitative Mean Reversion">
  <meta name="sp-level" content="Advanced"><meta name="sp-order" content="63">
  <link rel="canonical" href="https://education.signalpilot.io/curriculum/advanced/63-statistical-arbitrage.html">
  <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Gugi&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
  <!-- SignalPilot Theme System -->
  <link rel="stylesheet" href="/assets/signalpilot-theme.css">
  <link rel="stylesheet" href="/assets/edu.css">
  <link rel="stylesheet" href="/assets/chatbot.css">
  <link rel="stylesheet" href="/assets/lang-switcher.css">
  <link rel="stylesheet" href="/assets/notes.css">
  <link rel="stylesheet" href="/assets/auth-ui.css">
  <!-- Logger must load first -->
  <script src="/assets/logger.js"></script>
  <script src="/assets/dev-utils.js" defer></script>
  <script src="/assets/structured-data.js" defer></script>
  <script src="/assets/lazy-load.js" defer></script>
  <script defer data-domain="signalpilot.io" src="https://plausible.io/js/script.js"></script>
</head>
<body class="table-accordions-mobile">
  <div class="bg-stars" aria-hidden="true"></div>
  <canvas id="constellations" class="sp-constellations" aria-hidden="true"></canvas>
  <div class="bg-aurora" aria-hidden="true"></div>

<header class="sp-header">
  <div class="wrap">
    <a href="https://signalpilot.io" class="brand">
      <span>Signal Pilot</span>
    </a>
    <nav id="mainnav" aria-label="Main"><ul>
      <li><a href="/">Education</a></li>
      <li><a href="/search.html">Search</a></li>
      <li><a href="/my-library.html">üìö My Library</a></li>
    </ul></nav>
    <div class="header-ctls">
      <div id="google_translate_element"></div><button id="themeToggle" class="btn btn-ghost btn-sm" type="button" aria-label="Toggle theme">
        <span id="theme-icon">üåô</span>
      </button><button id="menuToggle" class="menu-toggle" aria-expanded="false">Menu ‚ò∞</button></div>
  </div>
</header>

<article class="article">

  <!-- Article Header -->
  <header>
    <div class="wrap">
      <nav class="breadcrumb" aria-label="Breadcrumb">
        <a href="/">Home</a> <span>‚Ä∫</span>
        <a href="/advanced.html">Advanced</a> <span>‚Ä∫</span>
        <span>Lesson #63</span>
      </nav>
      <span class="badge">üî¥ Advanced ‚Ä¢ Lesson 63 of 82</span>
      <h1 class="headline xl">Statistical Arbitrage: Quantitative Mean Reversion</h1>
      <div class="meta">Reading time ~18-22 min ‚Ä¢ Pairs Trading & Cointegration Analysis</div>

      <!-- Article Progress Indicator -->
      <div class="article-progress" style="--progress:0%">
        <div class="progress-circle"><span>0%</span></div>
        <div class="progress-text">
          <strong>You're making progress!</strong>
          <div style="font-size:.85rem;color:var(--muted)">Keep reading to mark this lesson complete</div>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <div class="wrap article-grid">
    <div class="prose">

      <p><b>Two assets walk into a bar. They're historically correlated‚Äîwhen one goes up, the other usually follows. Today? One rallies 5% while the other drops 3%.</b></p>

      <p>Do you panic? Short the strong one? Buy the weak one?</p>

      <p>Or do you recognize this as statistical arbitrage gold‚Äîa temporary divergence from long-term equilibrium that will eventually revert. If the relationship is <em>cointegrated</em> (not just correlated), you can trade the spread with quantified edge.</p>

      <div class="callout-warning">
        <h4>üö® This Isn't "Buy Dips" Hope Trading</h4>
        <p>Statistical arbitrage requires rigorous mathematical validation. You can't just eyeball two charts and assume they'll converge. You need cointegration tests, z-score models, and proper risk management‚Äîbecause spreads can diverge further before they converge.</p>
        <p><strong>Without quantitative validation?</strong> You're gambling, not arbitraging.</p>

      <div class="callout-tip">
        <h4>üéØ What You'll Master</h4>
        <p>By the end of this lesson, you'll understand:</p>
        <ul>
          <li>The difference between correlation and cointegration (critical!)</li>
          <li>How to identify viable pairs using Augmented Dickey-Fuller tests</li>
          <li>Z-score potential entry/potential exit models for statistical edge</li>
          <li>Position sizing based on spread volatility and half-life</li>
          <li>Real-world stat arb strategies used by hedge funds</li>
        </ul>
      </div>

      <details style="background:rgba(0,212,170,0.08);padding:1.5rem;border-radius:8px;margin:2rem 0;border-left:4px solid #00d4aa">
        <summary style="cursor:pointer;font-weight:600;font-size:1.1rem">‚ö° Quick Wins for Tomorrow (Click to expand)</summary>
        <div style="margin-top:1rem">
          <p>Don't overwhelm yourself. Start with these 3 actions:</p>
          <ol style="margin:0.75rem 0 0 1.5rem;line-height:1.8">
            <li><strong>Test Your First Pair for Cointegration Tonight Using Python (Find Out if SPY-QQQ Actually Mean Reverts BEFORE Risking Money)</strong> ‚Äî Derek Walsh lost $47,200 over 8 months (March-October 2023) trading "correlated pairs" that WEREN'T cointegrated. He saw SPY and QQQ move together (0.92 correlation), assumed they'd always revert, and traded the spread. August 2023: SPY outperformed QQQ by 4.8% in one month. Derek shorted SPY, bought QQQ, expecting reversion. It never came. The spread widened to 7.2%, then 9.4% over 3 months. He held on (no stop loss), believing "it HAS to revert." Final loss: -$47,200. Why? High correlation ‚â† cointegration. Correlated assets can DRIFT APART permanently. Cointegrated assets have a MATHEMATICAL RELATIONSHIP that pulls them back together. The fix: Test for cointegration using the Augmented Dickey-Fuller (ADF) test BEFORE trading any pair. Tonight's action: Install Python libraries: `pip install pandas yfinance statsmodels`. Copy this code to test SPY-QQQ cointegration: `import yfinance as yf; from statsmodels.tsa.stattools import coint; spy = yf.download('SPY', start='2020-01-01')['Adj Close']; qqq = yf.download('QQQ', start='2020-01-01')['Adj Close']; score, pvalue, _ = coint(spy, qqq); print(f'Cointegration p-value: {pvalue}')`. Run it. If p-value < 0.05 ‚Üí Cointegrated (tradeable pair). If p-value > 0.05 ‚Üí NOT cointegrated (don't trade). Tomorrow, test 5 potential pairs: SPY-IWM, GLD-SLV, XLE-XLF, USO-XLE, TLT-IEF. Only trade pairs with p-value < 0.05. This single test prevents $40K+ losses from trading fake pairs.</li>
            <li><strong>Build Your Z-Score Spreadsheet This Week (Know EXACTLY When to Enter and Exit Based on Statistical Edge, Not Gut Feel)</strong> ‚Äî Amanda Chen lost $38,900 over 6 months (January-June 2024) trading pairs with NO entry/exit rules. She'd see a spread widen, think "this looks big," enter, then panic-exit when it widened more. No system. All emotion. Result: 67 trades, 28 wins (42% win rate), -$38,900 loss. The fix: Use z-scores to quantify WHEN the spread is statistically extreme. Z-score = (Current Spread - Average Spread) / Spread Standard Deviation. If z > +2.0 = spread is 2 standard deviations above mean (RARE event, likely to revert DOWN). If z < -2.0 = spread 2 SD below mean (likely to revert UP). Entry rule: Enter when |z| > 2.0. Exit rule: Exit when z returns to 0 (mean). Tonight's action: Open Google Sheets. Create a "Pairs Trading Tracker" with columns: Date, Asset A Price, Asset B Price, Spread (A - Hedge Ratio √ó B), 20-Day Avg Spread, 20-Day Spread StdDev, Z-Score = (Spread - Avg) / StdDev, Signal (BUY if z < -2, SELL if z > +2, FLAT if |z| < 1). Tomorrow, pick ONE cointegrated pair (e.g., SPY-IWM). Calculate daily spread for past 60 days. Calculate rolling 20-day average and standard deviation. Compute z-score. Look for historical z-score extremes (|z| > 2). Backtest: If you entered at z = ¬±2 and exited at z = 0, what would your win rate and profit have been? This gives you statistical confidence BEFORE live trading. Example: SPY-IWM z-score hits +2.5 (spread extremely wide). You SHORT SPY, LONG IWM. When z returns to 0 (spread normalizes), you exit. Average profit per trade: 1.2-2.5% per pair over 3-10 days. This system eliminates guesswork and emotional exits.</li>
            <li><strong>Start Paper Trading ONE Pair for 30 Days (Prove the Math Works Before Deploying Capital)</strong> ‚Äî Michael Torres lost $52,400 in his first 60 days of live stat arb trading (September-October 2024) because he went straight from theory to real money without testing execution. He understood cointegration, calculated z-scores correctly, but failed at execution: (1) Entered too early (z = 1.5 instead of 2.0), (2) Exited too early (z = 0.5 instead of 0, missed half the reversion), (3) Oversized positions (5% per pair instead of 2%), (4) No stop loss when spreads widened past z = 3.0. Result: Theory was right, execution destroyed him. Total loss: -$52,400. The fix: Paper trade for 30 days to master execution without risk. November 2024: Michael started over with a paper account. ONE pair (XLE-XLF, energy vs. financials). Rules: Enter at z ‚â• 2.0, exit at z ‚â§ 0.5, stop loss at z ‚â• 3.0 (spread diverging too far), position size 2% of account. Result after 30 days: 12 trades, 9 wins (75% win rate), +$4,200 paper profit (would've been real if live). Why it worked: He proved he could EXECUTE the system without emotional interference. December 2024: Went live with real money. Same rules. Result (Dec 2024-Feb 2025): +$18,700 profit in 3 months. Why? He validated execution BEFORE risking capital. Tonight's action: Open a paper trading account (Thinkorswim, TradeStation, Interactive Brokers all offer free paper accounts). Choose ONE cointegrated pair (start simple: SPY-IWM or GLD-SLV). Set your rules: Entry z-score (‚â•2.0), Exit z-score (‚â§0.5), Stop loss z-score (‚â•3.0), Position size (2% per pair). Tomorrow, start tracking the pair daily. When z-score hits your entry threshold, execute the paper trade: LONG underperformer, SHORT outperformer. Track the trade daily. Exit when z returns to 0. Log: Entry date, z-score at entry, exit date, z-score at exit, profit/loss. After 30 days and 10-15 paper trades, calculate: Win rate (target > 65%), Average profit per trade (target > 1.5%), Max drawdown (should be < 5%). If your paper results hit these targets ‚Üí go live with small size. If not ‚Üí keep paper trading until execution is flawless. This 30-day paper period prevents $50K+ in live trading mistakes.</li>
          </ol>
        </div>
      </details>

      <div class="section-break"><span>Part 1: Why Correlation ‚â† Cointegration</span></div>

      
      <div style="background:rgba(118,221,255,0.08);padding:1.5rem;border-radius:8px;margin:2rem 0;border-left:4px solid var(--accent)">
        <h3 style="margin:0 0 1rem 0">üéØ What You'll Learn</h3>
        <p style="margin:0 0 0.75rem 0">By the end of this lesson, you'll be able to:</p>
        <ul style="line-height:1.8;margin:0 0 0 1.5rem">
          <li>Stat arb: Trade mean-reversion of correlated pairs (SPY/QQQ, XLE/XLF)</li>
          <li>Pairs trading: Long underperformer, short outperformer when spread diverges</li>
          <li>Z-score: Measures standard deviations from mean</li>
          <li>Framework: Find 0.7+ correlated pairs ‚Üí Trade when z-score >2 ‚Üí Exit at mean</li>
        </ul>
      </div>
<h2 id="the-most-dangerous-misconception-in-pairs-trading">The Most Dangerous Misconception in Pairs Trading</h2>

      <p>Retail traders love to find "correlated pairs" and trade the divergence. SPY and QQQ move together, right? Tesla and Lucid? Bitcoin and Ethereum?</p>

      <p>Here's the trap: <strong>Correlation does not guarantee mean reversion</strong>.</p>

      <p>Two assets can be highly correlated yet drift apart permanently. Why? Because correlation measures <em>direction</em>, not <em>equilibrium</em>.</p>

      <div class="tabs">
        <div class="tabs-nav">
          <button>Correlation (Dangerous)</button>
          <button>Cointegration (Required)</button>
        </div>
        <div class="tabs-content">
          <div class="tab-panel">
            <h3 id="correlation-moves-together-maybe">Correlation: Moves Together, Maybe</h3>
            <p><strong>Definition:</strong> Measures how two assets move in the same direction</p>
            <p><strong>Range:</strong> -1 (perfect inverse) to +1 (perfect positive)</p>
            <p><strong>The Problem:</strong> High correlation doesn't mean they'll return to any specific relationship. Example:</p>
            <ul>
              <li>Stock A: $100 ‚Üí $150 (+50%)</li>
              <li>Stock B: $50 ‚Üí $75 (+50%)</li>
              <li><strong>Correlation:</strong> Perfect 1.0</li>
              <li><strong>Spread:</strong> $50 throughout (no reversion)</li>
            </ul>
            <p style="margin-top:1rem;color:var(--warning)"><strong>Danger:</strong> You can't trade a spread that doesn't revert. This is why pure correlation-based pairs fail.</p>
          </div>
          <div class="tab-panel">
            <h3 id="cointegration-mean-reverting-equilibrium">Cointegration: Mean-Reverting Equilibrium</h3>
            <p><strong>Definition:</strong> A statistically stable long-term relationship where deviations are temporary</p>
            <p><strong>Test:</strong> Augmented Dickey-Fuller (ADF) test on the spread</p>
            <p><strong>What It Means:</strong> When the spread deviates, it's pulled back toward equilibrium. Example:</p>
            <ul>
              <li>Asset A / Asset B = typical ratio of 2.0</li>
              <li>Today: ratio = 2.4 (spread widened)</li>
              <li><strong>Cointegrated pairs:</strong> Ratio reverts toward 2.0</li>
              <li><strong>Edge:</strong> Sell the expensive one, buy the cheap one</li>
            </ul>
            <p style="margin-top:1rem;color:var(--success)"><strong>This Works:</strong> Mean reversion is statistically validated, not hoped for.</p>
          </div>
        </div>
      </div>

      <div class="callout-key">
        <h4>üí° The Key Insight</h4>
        <p>Correlation = "They move together"<br>
        Cointegration = "Their relationship has gravity"</p>
        <p>Only cointegrated pairs can be traded as statistical arbitrage. Everything else is speculation.</p>
      </div>

      <div class="section-break"><span>Part 1.5: The $31,400 Lesson‚ÄîDerek's Correlation Trap</span></div>

<div class="callout callout-danger">
  <h4>üìâ CASE STUDY: Derek's $31,400 Correlation vs. Cointegration Disaster (3 months)</h4>
  <p><strong>Trader:</strong> Derek Martinez, quantitative trader ($220K account), February-May 2024</p>
  <p><strong>Strategy:</strong> Pairs trading ARKK/QQQ based on 0.89 correlation. "When they diverge, they'll converge back."</p>
  <p><strong>Fatal flaw:</strong> Never tested for cointegration (no ADF test, no half-life calculation). Confused correlation (past similarity) with cointegration (mean-reverting spread)</p>
  <p><strong>Result:</strong> Lost $31,400 (-14.3%) in 3 months across 3 trades. Missed $26.8K profit opportunity by holding through reversal. Account: $220K ‚Üí $188.6K</p>

  <p><strong>The destruction (Feb-May 2024):</strong> Trade #1 (Feb 12-Mar 8): ARKK dropped, Derek bought thinking "cheap vs. QQQ," spread widened -$5.95 instead of reverting (ARKK continued underperforming). Loss: -$6,600. Trade #2 (Mar 15-Apr 19): Derek shorted ARKK thinking "overextended," but ARKK exploded +13.5% on genomics hype while QQQ only +1.1%, margin call forced close. Loss: -$15,200. Trade #3 (Apr 25-May 10): Revenge trade, shorted ARKK again. Initially up $26,831, then ARKK short squeezed +10.5% in 2 days, Derek held hoping for recovery, final exit -$8,400. Total: -$31,400 + missed $26.8K profit. Fatal mistakes: (1) Correlation ‚â† cointegration (0.89 correlation just means past similarity, NOT guaranteed mean reversion), (2) No ADF test (spread was NOT stationary), (3) No half-life (held 25+ days hoping with no statistical basis), (4) Ignored structural changes (ARKK pivoted to biotech, broke historical link with QQQ), (5) Revenge trading (entered Trade #3 emotionally without re-validation).</p>

  <p><strong>Recovery (Feb-Nov 2025, 9 months later):</strong> Derek spent months learning proper statistical arbitrage. New process: (1) ADF test EVERY pair (p-value must be <0.05 for stationary spread), (2) Calculate half-life (only trade if mean reversion <20 days), (3) Z-score entry (|Z| > 2.0 = 2+ std devs from mean), (4) Decointegration stop (if ADF p-value rises >0.10, exit immediately). Pairs traded: KO/PEP, XOM/CVX, JPM/BAC (all tested cointegrated). Results: 23 trades, 16 wins (69.6% win rate), avg win +$1,847, avg loss -$923, profit factor 3.2, +$23,094 profit (+12.2% in 9 months, Sharpe 1.94). Account: $188.6K ‚Üí $211.7K. Best trade: +$4,120 JPM/BAC (z-score 2.8 entry).</p>

  <div class="callout callout-purple" style="margin-top:1rem">
    <p><strong>Derek's advice 15 months later:</strong> "Correlation measures the PAST. Cointegration predicts the FUTURE. I lost $31,400 trading ARKK/QQQ because they were 'highly correlated.' But correlation just means they moved similarly historically. It doesn't mean they'll revert in the future. Once I learned to test for cointegration with ADF tests, everything changed. Now I only trade pairs where the spread is PROVEN to mean-revert (ADF p-value <0.05). My win rate went from 0% to 69.6%‚Äîand I sleep at night because I'm trading with statistical validation, not hope. Rule: If ADF p-value > 0.05, I don't touch it. No exceptions. I trade math, not correlation coefficients."</p>
  </div>
</div>

<div class="quiz-question" style="margin-top:2rem">
  <p><strong>Case Study Quiz: Derek lost $31,400 (-14.3%) in 3 months trading ARKK/QQQ pairs. He was confident because they showed 0.89 correlation‚Äîthey moved together historically. Trade #2 destroyed him: he shorted ARKK thinking it was "overextended vs. QQQ," but ARKK exploded +13.5% while QQQ only +1.1%, causing a margin call and -$15,200 loss. He also missed a $26,831 profit opportunity when the spread reversed but he held too long. What was Derek's fatal mistake?</strong></p>
  <div class="quiz-options">
    <div class="quiz-option" data-correct="false">
      <strong>A)</strong> He used too much leverage on the pairs trade, causing margin calls when spreads widened temporarily
    </div>
    <div class="quiz-option" data-correct="false">
      <strong>B)</strong> He held positions too short (under 10 days), not giving mean reversion enough time to occur
    </div>
    <div class="quiz-option" data-correct="true">
      <strong>C)</strong> He NEVER tested for cointegration‚Äîconfused correlation (0.89 = past similarity) with cointegration (mean-reverting spread). Never ran ADF test (p-value), never calculated half-life. The spread was NOT stationary, so reversion never came
    </div>
    <div class="quiz-option" data-correct="false">
      <strong>D)</strong> He entered at wrong z-scores (z=1.0 instead of z=2.0), so trades lacked statistical edge
    </div>
  </div>
  <div class="quiz-explanation">
    <p><strong>Correct: C.</strong> Derek's disaster came from confusing correlation with cointegration‚Äîhe saw ARKK/QQQ had 0.89 correlation (they moved together historically) and assumed they'd always revert when diverging. But correlation measures the PAST, cointegration predicts the FUTURE. He never ran an ADF test to verify the spread was stationary (mean-reverting). Trade #1: ARKK dropped, he bought thinking "cheap vs. QQQ," spread widened further, lost -$6,600. Trade #2: Shorted ARKK thinking "overextended," but ARKK exploded +13.5% on genomics hype while QQQ only +1.1%, margin call forced close, lost -$15,200. Trade #3: Initially up $26,831, but he held 25+ days with no statistical basis for how long reversion takes (no half-life calculation), ARKK short squeezed +10.5% in 2 days, final exit -$8,400. Structural issue: ARKK pivoted to biotech, breaking historical link with QQQ‚Äîcorrelation persisted but cointegration DIED. His recovery: learned proper stat arb‚Äî(1) ADF test EVERY pair (p-value <0.05 required), (2) Calculate half-life (<20 days), (3) Z-score entry (|Z| >2.0), (4) Decointegration stop (if ADF p-value rises >0.10, exit immediately). Result: 69.6% win rate, +$23,094 profit in 9 months. Lesson: High correlation doesn't guarantee mean reversion. Test for cointegration first.</p>
  </div>
</div>

      <div class="section-break"><span>Part 2: Testing for Cointegration‚ÄîThe Augmented Dickey-Fuller Test</span></div>

<h2 id="the-augmented-dickey-fuller-test">The Augmented Dickey-Fuller Test</h2>

      <p>To validate cointegration, you need to test whether the spread (or ratio) is <strong>stationary</strong>‚Äîmeaning it has a constant mean it reverts to.</p>

      <p>The standard test: <strong>Augmented Dickey-Fuller (ADF) test</strong>.</p>

      <div class="callout-info" style="background:rgba(118,221,255,0.08);padding:1.5rem;border-radius:8px;margin:2rem 0;border-left:4px solid var(--accent)">
        <h4>üìê What the ADF Test Does</h4>
        <p>The ADF test checks if a time series (like the spread between two assets) is <strong>stationary</strong> or has a <strong>unit root</strong> (random walk, non-stationary).</p>
        <ul style="margin:0.5rem 0 0 1.5rem;line-height:1.8">
          <li><strong>Stationary spread:</strong> Has a constant mean and variance. Deviations from the mean are temporary ‚Üí mean reversion is expected.</li>
          <li><strong>Non-stationary spread:</strong> Drifts over time with no equilibrium. Deviations can persist indefinitely ‚Üí no reliable mean reversion.</li>
        </ul>
        <p style="margin-top:1rem"><strong>Null Hypothesis (H‚ÇÄ):</strong> The spread has a unit root (NOT stationary, NOT cointegrated)</p>
        <p><strong>Alternative Hypothesis (H‚ÇÅ):</strong> The spread is stationary (cointegrated, mean-reverting)</p>
      </div>

      <h3 id="interpreting-adf-test-results">Interpreting ADF Test Results</h3>

      <p>The ADF test outputs a <strong>p-value</strong> that tells you the probability that the spread is non-stationary (random walk).</p>

      <div style="overflow-x:auto;margin:1.5rem 0">
      <table style="width:100%;border-collapse:collapse">
        <thead>
          <tr style="background:rgba(255,255,255,0.03)">
            <th style="padding:0.75rem;text-align:left">P-Value</th>
            <th style="padding:0.75rem;text-align:left">Interpretation</th>
            <th style="padding:0.75rem;text-align:left">Trade Decision</th>
          </tr>
        </thead>
        <tbody>
          <tr style="background:rgba(34,197,94,0.08)">
            <td style="padding:0.75rem"><strong>&lt; 0.01</strong></td>
            <td style="padding:0.75rem">Highly stationary (99% confidence)</td>
            <td style="padding:0.75rem;font-weight:600;color:#22c55e">‚úÖ TRADEABLE (strong cointegration)</td>
          </tr>
          <tr style="background:rgba(34,197,94,0.12)">
            <td style="padding:0.75rem"><strong>0.01 - 0.05</strong></td>
            <td style="padding:0.75rem">Stationary (95% confidence)</td>
            <td style="padding:0.75rem;font-weight:600;color:#22c55e">‚úÖ TRADEABLE (acceptable cointegration)</td>
          </tr>
          <tr style="background:rgba(255,193,7,0.08)">
            <td style="padding:0.75rem"><strong>0.05 - 0.10</strong></td>
            <td style="padding:0.75rem">Weakly stationary (90% confidence)</td>
            <td style="padding:0.75rem;font-weight:600;color:#ffc107">‚ö†Ô∏è MARGINAL (risky, watch closely)</td>
          </tr>
          <tr style="background:rgba(239,68,68,0.08)">
            <td style="padding:0.75rem"><strong>&gt; 0.10</strong></td>
            <td style="padding:0.75rem">Non-stationary (random walk)</td>
            <td style="padding:0.75rem;font-weight:600;color:#ef4444">‚ùå DO NOT TRADE (not cointegrated)</td>
          </tr>
        </tbody>
      </table>
      </div>

      <div class="callout-success" style="background:rgba(34,197,94,0.08);padding:1.5rem;border-radius:8px;margin:2rem 0;border-left:4px solid #22c55e">
        <h4>‚úÖ Rule of Thumb</h4>
        <p><strong>Only trade pairs with ADF p-value &lt; 0.05.</strong> This gives you 95% statistical confidence that the spread will mean-revert.</p>
        <p style="margin-top:0.75rem">If p-value &gt; 0.05, you're trading correlation, not cointegration‚Äîand that's gambling.</p>
      </div>

      <h3 id="calculating-hedge-ratio">Calculating the Hedge Ratio</h3>

      <p>Before running the ADF test, you need to determine the <strong>hedge ratio (Œ≤)</strong>‚Äîthe optimal proportion to balance the two assets in the pair.</p>

      <p><strong>Method:</strong> Run an Ordinary Least Squares (OLS) regression:</p>

      <p style="font-size:1.1rem;text-align:center;margin:1.5rem 0;background:var(--surface-2);padding:1rem;border-radius:8px">
        Asset A = Œ≤ √ó Asset B + Œµ
      </p>

      <p><strong>Œ≤ (beta) = hedge ratio</strong></p>

      <p><strong>Example: KO vs PEP</strong></p>
      <pre style="background:rgba(0,212,170,.05);padding:1rem;border-radius:6px;overflow-x:auto">
<strong>Step 1: Collect Historical Prices</strong>
KO (Coca-Cola): Last 252 days of closing prices
PEP (PepsiCo): Last 252 days of closing prices

<strong>Step 2: Run OLS Regression (KO = Œ≤ √ó PEP)</strong>
Using Python statsmodels or Excel LINEST function
Result: Œ≤ = 1.12

<strong>Interpretation:</strong>
For every $1 of PEP, you need $1.12 of KO to create a hedged pair.

<strong>Step 3: Calculate Spread</strong>
Spread = KO - (1.12 √ó PEP)

Example values:
- KO = $60.50
- PEP = $180.20
- Spread = $60.50 - (1.12 √ó $180.20) = $60.50 - $201.82 = -$141.32

<strong>Step 4: Run ADF Test on Spread</strong>
ADF Test Result: p-value = 0.018 ‚úÖ
Interpretation: Spread is stationary (cointegrated at 98% confidence)
Conclusion: KO/PEP is a tradeable pair
      </pre>

      <h3 id="real-example-spy-iwm-cointegration-test">Real Example: SPY/IWM Cointegration Test</h3>

      <div style="overflow-x:auto;margin:1.5rem 0">
      <table style="width:100%;border-collapse:collapse">
        <thead>
          <tr style="background:rgba(255,255,255,0.03)">
            <th style="padding:0.75rem;text-align:left">Step</th>
            <th style="padding:0.75rem;text-align:left">Process</th>
            <th style="padding:0.75rem;text-align:left">Result</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="padding:0.75rem"><strong>1. Data Collection</strong></td>
            <td style="padding:0.75rem">Download 1 year of daily prices for SPY and IWM</td>
            <td style="padding:0.75rem">252 trading days</td>
          </tr>
          <tr>
            <td style="padding:0.75rem"><strong>2. Correlation Check</strong></td>
            <td style="padding:0.75rem">Calculate Pearson correlation</td>
            <td style="padding:0.75rem">r = 0.94 (high correlation)</td>
          </tr>
          <tr>
            <td style="padding:0.75rem"><strong>3. OLS Regression</strong></td>
            <td style="padding:0.75rem">SPY = Œ≤ √ó IWM + Œµ</td>
            <td style="padding:0.75rem">Œ≤ = 2.68 (hedge ratio)</td>
          </tr>
          <tr>
            <td style="padding:0.75rem"><strong>4. Spread Calculation</strong></td>
            <td style="padding:0.75rem">Spread = SPY - (2.68 √ó IWM)</td>
            <td style="padding:0.75rem">252 spread values</td>
          </tr>
          <tr style="background:rgba(34,197,94,0.08)">
            <td style="padding:0.75rem"><strong>5. ADF Test</strong></td>
            <td style="padding:0.75rem">Test if spread is stationary</td>
            <td style="padding:0.75rem;font-weight:600;color:#22c55e">p = 0.0082 ‚úÖ COINTEGRATED</td>
          </tr>
          <tr>
            <td style="padding:0.75rem"><strong>6. Half-Life</strong></td>
            <td style="padding:0.75rem">How long for 50% mean reversion?</td>
            <td style="padding:0.75rem">8.2 days (fast reversion)</td>
          </tr>
          <tr style="background:rgba(34,197,94,0.12)">
            <td style="padding:0.75rem"><strong>7. Conclusion</strong></td>
            <td style="padding:0.75rem">Is this pair tradeable?</td>
            <td style="padding:0.75rem;font-weight:600;color:#22c55e">YES - Trade the spread</td>
          </tr>
        </tbody>
      </table>
      </div>

      <div class="callout-danger">
        <h4>üö® Common Mistakes in Cointegration Testing</h4>
        <ul style="margin:0.5rem 0 0 1.5rem;line-height:1.8">
          <li><strong>Using too short a lookback period:</strong> Need at least 6-12 months of data for reliable ADF test. 1-3 months = unreliable.</li>
          <li><strong>Not recalculating Œ≤ regularly:</strong> Hedge ratios drift over time. Recalculate monthly or you'll trade the wrong spread.</li>
          <li><strong>Ignoring p-value drift:</strong> A pair cointegrated in January may decointegrate by June. Re-test monthly.</li>
          <li><strong>Testing only once:</strong> Cointegration is dynamic, not static. Rolling window tests (6-month rolling) are essential.</li>
        </ul>
      </div>

      <div class="section-break"><span>Part 3: Z-Score Trading Models‚ÄîEntry & Exit Signals</span></div>

      <h2 id="z-score-the-trading-signal">Z-Score: The Trading Signal</h2>

      <p>Once you've confirmed cointegration (ADF p &lt; 0.05), you need a <strong>trading signal</strong> to tell you WHEN to enter and exit. That signal is the <strong>z-score</strong>.</p>

      <div class="callout-info" style="background:rgba(118,221,255,0.08);padding:1.5rem;border-radius:8px;margin:2rem 0;border-left:4px solid var(--accent)">
        <h4>üìê Z-Score Formula</h4>
        <p style="font-size:1.1rem;text-align:center;margin:1rem 0;background:var(--surface-2);padding:1rem;border-radius:8px">
          Z = (Current Spread - Mean Spread) / Standard Deviation of Spread
        </p>
        <p><strong>What it measures:</strong> How many standard deviations the current spread is from its historical mean.</p>
        <ul style="margin:0.5rem 0 0 1.5rem;line-height:1.8">
          <li><strong>Z = 0:</strong> Spread is at its mean (no trade)</li>
          <li><strong>Z = +2:</strong> Spread is 2 standard deviations ABOVE mean (Asset A expensive, Asset B cheap)</li>
          <li><strong>Z = -2:</strong> Spread is 2 standard deviations BELOW mean (Asset A cheap, Asset B expensive)</li>
        </ul>
      </div>

      <h3 id="z-score-trading-frameworks">Z-Score Trading Frameworks</h3>

      <div class="tabs">
        <div class="tabs-nav">
          <button>Conservative Model</button>
          <button>Aggressive Model</button>
        </div>
        <div class="tabs-content">
          <div class="tab-panel">
            <h3 id="conservative-z-score-model">Conservative Z-Score Model</h3>
            <ul>
              <li><strong>Entry:</strong> |Z| > 2.0 (spread is 2+ std devs from mean)</li>
              <li><strong>Exit:</strong> Z crosses back through 0 (mean reversion)</li>
              <li><strong>Stop Loss:</strong> |Z| > 3.5 (spread widening, cut losses)</li>
            </ul>
            <p style="margin-top:1rem"><strong>Why Conservative:</strong></p>
            <ul>
              <li>Z > 2 means 95% confidence the spread is abnormal</li>
              <li>Fewer false signals, higher win rate</li>
              <li>Lower frequency (fewer trades)</li>
            </ul>
          </div>
          <div class="tab-panel">
            <h3 id="aggressive-z-score-model">Aggressive Z-Score Model</h3>
            <ul>
              <li><strong>Entry:</strong> |Z| > 1.5 (more frequent signals)</li>
              <li><strong>Partial Exit:</strong> Z crosses 0.5 (take some profit)</li>
              <li><strong>Full Exit:</strong> Z crosses 0 (mean)</li>
              <li><strong>Stop Loss:</strong> |Z| > 3.0</li>
            </ul>
            <p style="margin-top:1rem"><strong>Why Aggressive:</strong></p>
            <ul>
              <li>More trades = more opportunities</li>
              <li>Lower threshold = earlier entries</li>
              <li>Requires tighter risk management</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="callout-key">
        <h4>üí° Real-World Application</h4>
        <p><strong>Spread = $5.20</strong><br>
        <strong>Mean Spread = $5.00</strong><br>
        <strong>Std Dev = $0.10</strong></p>
        <p><strong>Z-score = ($5.20 - $5.00) / $0.10 = 2.0</strong></p>
        <p><strong>Action:</strong> Asset A is relatively expensive, Asset B is relatively cheap</p>
        <p><strong>Trade:</strong> Short Asset A, Long Asset B (expect convergence)</p>
      </div>
<h3 id="half-life-how-long-until-reversion">Half-Life: How Long Until Reversion?</h3>

      <p>The half-life tells you how many periods it takes for the spread to revert halfway back to the mean. This informs your holding period.</p>
<div class="callout-info" style="background:rgba(0,212,170,0.1);border-left:4px solid #00d4aa;margin:2rem 0">
  <p>You're now at the halfway point. You've learned the key strategies.</p>
  <p style="margin-top:0.5rem;font-size:0.9rem">Great progress! Take a quick stretch break if needed, then we'll dive into the advanced concepts ahead.</p>
</div>

      <div class="callout-info">
        <h4>üìñ Calculating Half-Life</h4>
        <p>Use an AR(1) model (autoregressive) on the spread:</p>
        <p style="text-align:center;margin:1rem 0">Spread<sub>t</sub> = Œ∏ √ó Spread<sub>t-1</sub> + Œµ</p>
        <p><strong>Half-Life = -log(2) / log(Œ∏)</strong></p>
        <p><strong>Example:</strong> If Œ∏ = 0.95, Half-Life ‚âà 14 days</p>
        <p><strong>Implication:</strong> Expect mean reversion within ~14 days. If it takes 30+ days, your model may be breaking down.</p>
      </div>

      <div class="section-break"><span>Part 4: Position Sizing & Risk Management</span></div>
<h2 id="how-much-to-allocate-per-trade">How Much to Allocate Per Trade</h2>

      <p>Statistical arbitrage is NOT "set it and forget it." Spreads can widen before they converge (drawdowns), and some pairs decointegrate over time.</p>

      <h3 id="kelly-criterion-for-stat-arb">Kelly Criterion for Stat Arb</h3>

      <p>Use a modified Kelly approach:</p>

      <p style="font-size:1.1rem;text-align:center;margin:1.5rem 0;background:var(--surface-2);padding:1rem;border-radius:8px">f* = (p √ó b - q) / b</p>

      <p>Where:</p>
      <ul>
        <li><strong>p</strong> = win rate (historical % of profitable mean reversions)</li>
        <li><strong>q</strong> = loss rate (1 - p)</li>
        <li><strong>b</strong> = average win / average loss</li>
        <li><strong>f*</strong> = optimal fraction of capital to risk</li>
      </ul>

      <div class="callout-warning">
        <h4>üö® Never Risk More Than 2-5% Per Pair</h4>
        <p>Even if Kelly suggests 10%, stat arb models can fail (decointegration, regime change). Use half-Kelly or quarter-Kelly for safety:</p>
        <p><strong>Half-Kelly:</strong> f* / 2<br>
        <strong>Quarter-Kelly:</strong> f* / 4</p>
        <p>This protects you from model potential breakdown while still capturing edge.</p>
      </div>
<h3 id="portfolio-of-pairs-diversification">Portfolio of Pairs: Diversification</h3>

      <p>Don't run just one pair. Build a portfolio of 5-10 cointegrated pairs across different sectors to reduce idiosyncratic risk.</p>

      <div class="accordion">
        <details class="accordion-item">
          <summary class="accordion-header">Example Stat Arb Portfolio</summary>
          <div class="accordion-content">
            <ul>
              <li><strong>Pair 1:</strong> KO vs PEP (Consumer Staples)</li>
              <li><strong>Pair 2:</strong> XOM vs CVX (Energy)</li>
              <li><strong>Pair 3:</strong> JPM vs BAC (Financials)</li>
              <li><strong>Pair 4:</strong> AAPL vs MSFT (Tech)</li>
              <li><strong>Pair 5:</strong> UNH vs CVS (Healthcare)</li>
            </ul>
            <p style="margin-top:1rem"><strong>Benefit:</strong> If one pair decointegrates, others can still perform</p>
            <p><strong>Risk per Pair:</strong> 2% of capital max</p>
            <p><strong>Total Portfolio Risk:</strong> 10% across 5 uncorrelated pairs</p>
          </div>
        </details>
      </div>

      <div class="section-break"><span>Part 5: When Stat Arb Fails</span></div>
<h2 id="regime-changes-decointegration">Regime Changes & Decointegration</h2>

      <p>Statistical arbitrage works‚Äîuntil it doesn't. Pairs can <strong>decointegrate</strong> due to:</p>

      <ul>
        <li><strong>Corporate Actions:</strong> Mergers, spinoffs, dividend changes</li>
        <li><strong>Structural Shifts:</strong> One company changes business model</li>
        <li><strong>Macro Regime Change:</strong> Interest rate shocks, sector rotation</li>
        <li><strong>Liquidity Drying Up:</strong> Can't potential exit the position without slippage</li>
      </ul>

      <div class="callout-warning">
        <h4>üö® Real Example: LTCM Collapse (1998)</h4>
        <p>Long-Term Capital Management was a stat arb hedge fund run by Nobel Prize winners. They traded bond spreads with mathematical precision.</p>
        <p><strong>What Went Wrong:</strong> Russian debt crisis caused spreads to widen far beyond historical norms. LTCM kept adding to positions (z-score hit 10+), expecting reversion.</p>
        <p><strong>Result:</strong> $4.6 billion loss. Near collapse of the financial system.</p>
        <p><strong>Lesson:</strong> Statistical models assume normal distributions. Black swan events break those assumptions. Always have stop losses.</p>
      </div>
<h3 id="stop-loss-rules-for-stat-arb">Stop Loss Rules for Stat Arb</h3>

      <ul>
        <li><strong>Z-Score Stop:</strong> Exit if |Z| > 3.5 (spread widening, not reverting)</li>
        <li><strong>Time Stop:</strong> Exit if position is open > 2√ó half-life (model failing)</li>
        <li><strong>Dollar Stop:</strong> Exit if drawdown exceeds 50% of expected profit</li>
        <li><strong>Correlation Breakdown:</strong> Exit if ADF p-value goes above 0.10 (losing cointegration)</li>
      </ul>

      <div class="section-break"><span>Part 6: Practical Implementation</span></div>
<h2 id="building-your-stat-arb-system">Building Your Stat Arb System</h2>

      <p>Step-by-step process for running statistical arbitrage:</p>

      <div class="accordion">
        <details class="accordion-item">
          <summary class="accordion-header">Step 1: Pair Discovery (Screen for Candidates)</summary>
          <div class="accordion-content">
            <p><strong>Method:</strong> Screen stocks in the same sector or ETFs tracking similar indices</p>
            <p><strong>Tools:</strong> Python (statsmodels library for ADF test), QuantConnect, or custom scripts</p>
            <p><strong>Criteria:</strong></p>
            <ul>
              <li>Similar market cap (liquidity)</li>
              <li>Same industry/sector (fundamental link)</li>
              <li>High correlation (>0.7) as initial filter</li>
            </ul>
          </div>
        </details>

        <details class="accordion-item">
          <summary class="accordion-header">Step 2: Cointegration Testing</summary>
          <div class="accordion-content">
            <p><strong>Run ADF test on the spread:</strong></p>
            <ul>
              <li>Use 6-12 months of daily data</li>
              <li>Calculate spread: Asset A - (Œ≤ √ó Asset B)</li>
              <li>ADF p-value < 0.05 = pass</li>
            </ul>
            <p style="margin-top:1rem"><strong>Reject pairs with p > 0.05</strong> (not cointegrated)</p>
          </div>
        </details>

        <details class="accordion-item">
          <summary class="accordion-header">Step 3: Backtesting</summary>
          <div class="accordion-content">
            <p><strong>Test z-score model on historical data:</strong></p>
            <ul>
              <li>Entry at |Z| > 2, potential exit at Z = 0</li>
              <li>Calculate win rate, avg profit/loss, Sharpe ratio</li>
              <li>Verify half-life is reasonable (5-30 days)</li>
            </ul>
            <p style="margin-top:1rem"><strong>If Sharpe > 1.5 and win rate > 60%, proceed to live testing</strong></p>
          </div>
        </details>

        <details class="accordion-item">
          <summary class="accordion-header">Step 4: Live Monitoring</summary>
          <div class="accordion-content">
            <p><strong>Track daily:</strong></p>
            <ul>
              <li>Current z-score (potential entry/exit signals)</li>
              <li>Spread volatility (risk sizing)</li>
              <li>Correlation (warning if dropping)</li>
              <li>Re-run ADF test monthly (check for decointegration)</li>
            </ul>
          </div>
        </details>
      </div>

      <div class="callout-tip">
        <h4>üéØ Pro Tip: Use Rolling Windows</h4>
        <p>Don't calculate cointegration once and assume it's stable forever. Use a <strong>rolling 6-month window</strong> to recalculate Œ≤ and re-test ADF every month.</p>
        <p>If p-value drifts above 0.10, potential exit the pair‚Äîit's decointegrating.</p>
      </div>

      <div class="section-break"><span>Part 7: Advanced Strategies‚ÄîIntraday Statistical Arbitrage</span></div>
<h2 id="high-frequency-mean-reversion-for-active-traders">High-Frequency Mean Reversion (For Active Traders)</h2>

      <p>Most stat arb is swing trading (holding 5-30 days), but cointegration also works on intraday timeframes‚Äîif you have the infrastructure.</p>

      <h3 id="requirements-for-intraday-stat-arb">Requirements for Intraday Stat Arb</h3>

      <ul>
        <li><strong>Low Latency Execution:</strong> Sub-second fills required (DMA or sponsored access)</li>
        <li><strong>High-Liquidity Pairs:</strong> SPY/IWM, QQQ/DIA, sector ETFs only</li>
        <li><strong>Tight Spreads:</strong> Commission + slippage must be <0.02% per trade</li>
        <li><strong>Automated System:</strong> Manual trading too slow for 5-minute half-lives</li>
      </ul>

      <div class="accordion">
        <details class="accordion-item">
          <summary class="accordion-header">Example: SPY vs IWM Intraday Pairs</summary>
          <div class="accordion-content">
            <p><strong>Pair Logic:</strong></p>
            <ul>
              <li>SPY = S&P 500 (large cap)</li>
              <li>IWM = Russell 2000 (small cap)</li>
              <li>Correlation: 0.92 (5-minute bars)</li>
              <li>ADF test (5-min spread): p = 0.009 ‚úÖ Cointegrated!</li>
              <li>Half-life: 12 bars (60 minutes)</li>
            </ul>
            <p style="margin-top:1rem"><strong>Entry Rules:</strong></p>
            <ul>
              <li>Calculate 5-min rolling z-score</li>
              <li>Entry: |Z| > 1.8 (more aggressive than daily)</li>
              <li>Exit: Z crosses 0 OR 90 minutes elapsed</li>
            </ul>
            <p style="margin-top:1rem"><strong>Example Trade (Nov 15, 2024):</strong></p>
            <ul>
              <li>10:35 AM: SPY at $595.20, IWM at $225.40</li>
              <li>Spread = SPY - (2.642 √ó IWM) = -$0.28</li>
              <li>Z-score = -1.95 (SPY cheap relative to IWM)</li>
              <li><strong>Trade:</strong> Long 200 SPY, Short 530 IWM</li>
            </ul>
            <p style="margin-top:1rem"><strong>Result:</strong></p>
            <ul>
              <li>11:20 AM: Spread reverts to +$0.05</li>
              <li>Z-score = +0.12 (mean reversion complete)</li>
              <li>Exit: Profit $142 in 45 minutes (0.12% return)</li>
            </ul>
            <p style="margin-top:1rem;color:var(--success)"><strong>Scalability:</strong> This trade works 8-12√ó per day with $50-200 profit each. Monthly return: ~3-5% with minimal overnight risk.</p>
          </div>
        </details>

        <details class="accordion-item">
          <summary class="accordion-header">Intraday Stat Arb Risks</summary>
          <div class="accordion-content">
            <p><strong>Why Most Retail Traders Fail at This:</strong></p>
            <ul>
              <li><strong>Commission Overhead:</strong> $0.005/share √ó 2 legs √ó multiple trades = eats profits</li>
              <li><strong>Slippage:</strong> Market orders on large size = instant -$50-100 loss</li>
              <li><strong>False Signals:</strong> Intraday noise creates 40-50% false z-score triggers</li>
              <li><strong>Technology Requirements:</strong> Need algo platform (QuantConnect, TradeStation, custom)</li>
            </ul>
            <p style="margin-top:1rem"><strong>Who Should Do This:</strong></p>
            <ul>
              <li>Traders with >$100K capital (need size for profit after costs)</li>
              <li>Access to professional routing (Interactive Brokers Pro, Lightspeed, etc.)</li>
              <li>Automated execution (no manual clicking)</li>
            </ul>
            <p style="margin-top:1rem"><strong>Who Should NOT:</strong></p>
            <ul>
              <li>Beginner traders (stick to daily/weekly stat arb)</li>
              <li>Anyone using Robinhood, Webull, etc. (too much slippage)</li>
              <li>Manual traders (you'll miss fills and get chopped up)</li>
            </ul>
          </div>
        </details>
      </div>

      <div class="section-break"><span>Part 8: Portfolio Construction for Stat Arb</span></div>
<h2 id="building-a-diversified-stat-arb-book">Building a Diversified Stat Arb Book</h2>

      <p>Single-pair trading is risky (decointegration can wipe you out). Professional stat arb traders run portfolios of 10-30 pairs simultaneously.</p>

      <h3 id="example-portfolio-allocation">Example Portfolio Allocation</h3>

      <div class="tabs">
        <div class="tabs-nav">
          <button>Conservative</button>
          <button>Moderate</button>
          <button>Aggressive</button>
        </div>
        <div class="tabs-content">
          <div class="tab-panel">
            <h3 id="conservative-stat-arb-portfolio-100k-account">Conservative Stat Arb Portfolio ($100K Account)</h3>
            <p><strong>Strategy:</strong> 5 pairs, 2% risk each, daily timeframe</p>
            <ul>
              <li><strong>Pair 1:</strong> KO/PEP (Consumer Staples) ‚Äî 2% allocation</li>
              <li><strong>Pair 2:</strong> JPM/BAC (Financials) ‚Äî 2% allocation</li>
              <li><strong>Pair 3:</strong> XOM/CVX (Energy) ‚Äî 2% allocation</li>
              <li><strong>Pair 4:</strong> UNH/CVS (Healthcare) ‚Äî 2% allocation</li>
              <li><strong>Pair 5:</strong> WMT/TGT (Retail) ‚Äî 2% allocation</li>
            </ul>
            <p style="margin-top:1rem"><strong>Total Risk:</strong> 10% of capital actively deployed</p>
            <p><strong>Expected Sharpe:</strong> 1.5-2.0</p>
            <p><strong>Expected Annual Return:</strong> 12-18%</p>
            <p><strong>Max Drawdown:</strong> -8% to -12%</p>
          </div>
          <div class="tab-panel">
            <h3 id="moderate-stat-arb-portfolio-100k-account">Moderate Stat Arb Portfolio ($100K Account)</h3>
            <p><strong>Strategy:</strong> 10 pairs, 1.5% risk each, mix of daily and intraday</p>
            <ul>
              <li><strong>Daily Pairs (6):</strong> Same as conservative, plus MA/V, DIS/CMCSA</li>
              <li><strong>Intraday Pairs (4):</strong> SPY/IWM, QQQ/DIA, XLF/XLK, XLE/XLU</li>
            </ul>
            <p style="margin-top:1rem"><strong>Total Risk:</strong> 15% of capital</p>
            <p><strong>Expected Sharpe:</strong> 2.0-2.5</p>
            <p><strong>Expected Annual Return:</strong> 20-30%</p>
            <p><strong>Max Drawdown:</strong> -12% to -18%</p>
          </div>
          <div class="tab-panel">
            <h3 id="aggressive-stat-arb-portfolio-100k-account">Aggressive Stat Arb Portfolio ($100K Account)</h3>
            <p><strong>Strategy:</strong> 20+ pairs, 1% risk each, heavy intraday focus</p>
            <ul>
              <li><strong>Daily Pairs (8):</strong> High Sharpe blue-chips</li>
              <li><strong>Intraday Pairs (12):</strong> ETF pairs with tight spreads</li>
              <li><strong>Leverage:</strong> 1.5√ó (using portfolio margin)</li>
            </ul>
            <p style="margin-top:1rem"><strong>Total Risk:</strong> 20% of capital (30% with leverage)</p>
            <p><strong>Expected Sharpe:</strong> 2.5-3.5 (if executed properly)</p>
            <p><strong>Expected Annual Return:</strong> 35-50%</p>
            <p><strong>Max Drawdown:</strong> -20% to -30%</p>
            <p style="margin-top:1rem;color:var(--warning)"><strong>Warning:</strong> Requires full-time monitoring, professional execution, and risk management discipline</p>
          </div>
        </div>
      </div>

      <div class="callout-warning">
        <h4>üö® Correlation Between Pairs (Hidden Risk)</h4>
        <p>Don't just diversify by adding more pairs. Check if your pairs are correlated with EACH OTHER:</p>
        <p><strong>Bad Portfolio:</strong></p>
        <ul>
          <li>KO/PEP, MDLZ/GIS, K/CPB (all food companies)</li>
          <li>If consumer staples sector crashes, ALL pairs move together</li>
          <li>Your 10 pairs = 1 bet (sector bet, not stat arb)</li>
        </ul>
        <p style="margin-top:1rem"><strong>Good Portfolio:</strong></p>
        <ul>
          <li>KO/PEP (consumer), JPM/BAC (finance), XOM/CVX (energy)</li>
          <li>Sector diversification = uncorrelated pair performance</li>
          <li>One sector crash doesn't kill entire portfolio</li>
        </ul>
      </div>
<h3 id="rebalancing-your-stat-arb-portfolio">Rebalancing Your Stat Arb Portfolio</h3>

      <div class="callout-info">
        <h4>üìñ Monthly Maintenance Checklist</h4>
        <p><strong>1st of Every Month:</strong></p>
        <ul>
          <li>Re-run ADF tests on ALL pairs (check for decointegration)</li>
          <li>Recalculate hedge ratios (Œ≤ may drift over time)</li>
          <li>Update z-score thresholds based on new volatility</li>
          <li>Remove pairs with p-value > 0.10 (losing cointegration)</li>
          <li>Add new pairs that pass screening criteria</li>
        </ul>
        <p style="margin-top:1rem"><strong>Example Decointegration Detection:</strong></p>
        <ul>
          <li>January: KO/PEP ADF p-value = 0.021 ‚úÖ</li>
          <li>February: p-value = 0.046 ‚úÖ (still good)</li>
          <li>March: p-value = 0.089 ‚ö†Ô∏è (warning)</li>
          <li>April: p-value = 0.124 ‚ùå (REMOVE from portfolio)</li>
        </ul>
        <p style="margin-top:1rem"><strong>Action:</strong> Close any open KO/PEP positions, find replacement pair</p>
      </div>

      <div class="section-break"><span>Part 9: Code Implementation (Python Example)</span></div>
<h2 id="building-your-stat-arb-system-from-scratch">Building Your Stat Arb System from Scratch</h2>

      <p>Here's a practical Python implementation for testing and trading pairs:</p>

      <div class="accordion">
        <details class="accordion-item">
          <summary class="accordion-header">Step 1: Testing for Cointegration</summary>
          <div class="accordion-content">
            <pre style="overflow-x:auto"><code>import pandas as pd
import numpy as np
from statsmodels.tsa.stattools import adfuller
from statsmodels.api import OLS

# Example: Test KO vs PEP cointegration
ko = pd.read_csv('KO_daily.csv')['Close']
pep = pd.read_csv('PEP_daily.csv')['Close']

# Calculate hedge ratio using OLS regression
model = OLS(ko, pep).fit()
beta = model.params[0]
print(f"Hedge Ratio (Œ≤): {beta:.4f}")

# Calculate spread
spread = ko - (beta * pep)

# Run ADF test on spread
adf_result = adfuller(spread)
p_value = adf_result[1]

if p_value < 0.05:
    print(f"‚úÖ COINTEGRATED! (p-value: {p_value:.4f})")
else:
    print(f"‚ùå NOT cointegrated (p-value: {p_value:.4f})")

# Calculate half-life
def calculate_half_life(spread):
    spread_lag = spread.shift(1)
    spread_diff = spread - spread_lag
    model = OLS(spread_diff[1:], spread_lag[1:]).fit()
    theta = model.params[0]
    half_life = -np.log(2) / np.log(1 + theta)
    return half_life

half_life = calculate_half_life(spread)
print(f"Half-Life: {half_life:.1f} days")
</code></pre>
          </div>
        </details>

        <details class="accordion-item">
          <summary class="accordion-header">Step 2: Calculating Z-Score Signals</summary>
          <div class="accordion-content">
            <pre style="overflow-x:auto"><code># Calculate rolling z-score
lookback = 60  # 60-day rolling window

spread_mean = spread.rolling(window=lookback).mean()
spread_std = spread.rolling(window=lookback).std()
z_score = (spread - spread_mean) / spread_std

# Entry/exit signals
potential entry_threshold = 2.0
potential exit_threshold = 0.0
stop_threshold = 3.5

# Long spread signal (buy asset A, sell asset B)
long_potential entry = z_score < -potential entry_threshold
long_potential exit = z_score > -potential exit_threshold

# Short spread signal (sell asset A, buy asset B)
short_potential entry = z_score > potential entry_threshold
short_potential exit = z_score < potential exit_threshold

# Stop loss
stop_loss = (z_score > stop_threshold) | (z_score < -stop_threshold)

print(f"Current Z-Score: {z_score.iloc[-1]:.2f}")
if z_score.iloc[-1] > potential entry_threshold:
    print("üî¥ SHORT SPREAD (sell KO, buy PEP)")
elif z_score.iloc[-1] < -potential entry_threshold:
    print("üü¢ LONG SPREAD (buy KO, sell PEP)")
else:
    print("‚ö™ NO TRADE (waiting for signal)")
</code></pre>
          </div>
        </details>

        <details class="accordion-item">
          <summary class="accordion-header">Step 3: Backtesting the Strategy</summary>
          <div class="accordion-content">
            <pre style="overflow-x:auto"><code># Simple backtest
position = 0  # 0 = no position, 1 = long spread, -1 = short spread
trades = []
pnl = []

for i in range(lookback, len(z_score)):
    z = z_score.iloc[i]

    # Entry logic
    if position == 0:
        if z < -potential entry_threshold:
            position = 1  # Long spread
            potential entry_price = spread.iloc[i]
        elif z > potential entry_threshold:
            position = -1  # Short spread
            potential entry_price = spread.iloc[i]

    # Exit logic
    elif position == 1:  # In long spread
        if z > -potential exit_threshold or z < -stop_threshold:
            potential exit_price = spread.iloc[i]
            profit = potential exit_price - potential entry_price
            trades.append(profit)
            position = 0

    elif position == -1:  # In short spread
        if z < potential exit_threshold or z > stop_threshold:
            potential exit_price = spread.iloc[i]
            profit = potential entry_price - potential exit_price
            trades.append(profit)
            position = 0

# Calculate statistics
win_rate = len([t for t in trades if t > 0]) / len(trades)
avg_win = np.mean([t for t in trades if t > 0])
avg_loss = np.mean([t for t in trades if t < 0])
profit_factor = abs(sum([t for t in trades if t > 0])) / abs(sum([t for t in trades if t < 0]))

print(f"Total Trades: {len(trades)}")
print(f"Win Rate: {win_rate:.1%}")
print(f"Avg Win: ${avg_win:.2f}")
print(f"Avg Loss: ${avg_loss:.2f}")
print(f"Profit Factor: {profit_factor:.2f}")
print(f"Total PnL: ${sum(trades):.2f}")
</code></pre>
        </div>
        </details>
      </div>

      <div class="callout-tip">
        <h4>üéØ Pro Tips for Live Trading</h4>
        <ul>
          <li><strong>Paper Trade First:</strong> Run your system for 1-3 months with fake money before risking capital</li>
          <li><strong>Start Small:</strong> 0.5-1% position sizes until you've proven your edge</li>
          <li><strong>Monitor Slippage:</strong> If your fills are >0.05% worse than backtest, reduce size or improve execution</li>
          <li><strong>Track Every Trade:</strong> Log potential entry z-score, potential exit z-score, hold time, P&L‚Äîanalyze what works</li>
        </ul>
      </div>

      <div class="section-break"><span>Key Takeaways</span></div>

      <div class="callout-key">
        <h4>üí° Statistical Arbitrage Checklist</h4>
        <ul>
          <li><strong>Cointegration > Correlation:</strong> Always validate with ADF test (p < 0.05)</li>
          <li><strong>Z-Score Entry:</strong> |Z| > 2.0 for conservative, > 1.5 for aggressive</li>
          <li><strong>Stop Losses:</strong> Exit if |Z| > 3.5 or position open > 2√ó half-life</li>
          <li><strong>Position Sizing:</strong> Never more than 2-5% per pair (use Kelly/half-Kelly)</li>
          <li><strong>Diversify Pairs:</strong> Run 5-10 pairs across different sectors</li>
          <li><strong>Monitor Continuously:</strong> Re-test cointegration monthly, potential exit if breaking down</li>
          <li><strong>Portfolio Construction:</strong> Ensure pairs are uncorrelated with each other (sector diversity)</li>
          <li><strong>Intraday Trading:</strong> Only with professional execution and automation</li>
        </ul>
      </div>
      <p style="font-size:1.1rem;font-weight:500;margin:2rem 0">Statistical arbitrage is a quantitative edge‚Äîbut it requires discipline. If you execute this correctly, you're trading with mathematical precision instead of hope.</p>

      <div class="quiz">
        <h3>Test Your Understanding</h3>

        <div class="quiz-question">
          <p><strong>Q1: What was Derek's fatal mistake that led to his $31,400 loss trading ARKK/QQQ?</strong></p>
          <div class="quiz-options">
            <div class="quiz-option" data-correct="false">A) He used too much leverage on his positions</div>
            <div class="quiz-option" data-correct="true">B) He confused correlation (0.89) with cointegration and never ran an ADF test</div>
            <div class="quiz-option" data-correct="false">C) He traded with too small position sizes and couldn't recover losses</div>
            <div class="quiz-option" data-correct="false">D) He exited winners too early instead of holding through reversions</div>
          </div>
          <div class="quiz-feedback">
            <p><strong>Correct!</strong> Derek's fundamental error was assuming that high correlation (0.89) meant the spread would mean-revert. He never tested for cointegration using the Augmented Dickey-Fuller test. Correlation only measures past similarity‚Äîit doesn't guarantee mean reversion. Cointegration validates that the spread has a statistically stable equilibrium it reverts to.</p>
          </div>
        </div>

        <div class="quiz-question">
          <p><strong>Q2: For a pairs trading strategy using statistical arbitrage, what ADF test p-value threshold indicates a valid cointegrated pair?</strong></p>
          <div class="quiz-options">
            <div class="quiz-option" data-correct="false">A) p-value > 0.10 (spread is non-stationary)</div>
            <div class="quiz-option" data-correct="true">B) p-value < 0.05 (spread is stationary and mean-reverting)</div>
            <div class="quiz-option" data-correct="false">C) p-value > 0.50 (high statistical confidence)</div>
            <div class="quiz-option" data-correct="false">D) p-value = 1.0 (perfect cointegration)</div>
          </div>
          <div class="quiz-feedback">
            <p><strong>Correct!</strong> A p-value < 0.05 from the Augmented Dickey-Fuller test indicates that the spread is stationary (mean-reverting) with 95% confidence. This is the threshold Derek should have used. If p-value > 0.05, the spread is NOT cointegrated and shouldn't be traded as statistical arbitrage. After Derek's losses, he adopted a strict rule: only trade pairs with ADF p-value < 0.05.</p>
          </div>
        </div>

        <div class="quiz-question">
          <p><strong>Q3: According to the lesson's conservative z-score strategy, when should you enter a statistical arbitrage pairs trade?</strong></p>
          <div class="quiz-options">
            <div class="quiz-option" data-correct="false">A) When |z-score| > 1.0 (spread is 1 standard deviation from mean)</div>
            <div class="quiz-option" data-correct="true">B) When |z-score| > 2.0 (spread is 2+ standard deviations from mean)</div>
            <div class="quiz-option" data-correct="false">C) When |z-score| > 0.5 (any deviation from equilibrium)</div>
            <div class="quiz-option" data-correct="false">D) When z-score returns to 0 (spread at mean)</div>
          </div>
          <div class="quiz-feedback">
            <p><strong>Correct!</strong> Conservative entry is |z-score| > 2.0, meaning the spread has deviated 2+ standard deviations from its mean‚Äîa statistically rare event likely to revert. Aggressive traders might use |z| > 1.5, but 2.0 provides higher confidence. You exit when z-score returns to 0 (mean). If z-score reaches 3.5+, you should stop out as the spread may be de-cointegrating.</p>
          </div>
        </div>

        <div class="quiz-question">
          <p><strong>Q4: What's the critical difference between correlation and cointegration?</strong></p>
          <div class="quiz-options">
            <div class="quiz-option" data-correct="false">A) Correlation is for stocks, cointegration is for futures only</div>
            <div class="quiz-option" data-correct="false">B) Correlation requires mathematical tests, cointegration can be eyeballed</div>
            <div class="quiz-option" data-correct="true">C) Correlation measures past directional similarity; cointegration means the spread has a mean-reverting equilibrium relationship</div>
            <div class="quiz-option" data-correct="false">D) There's no difference‚Äîthey're the same concept with different names</div>
          </div>
          <div class="quiz-feedback">
            <p><strong>Correct!</strong> This is the core lesson: Correlation = "they moved together in the past" (direction). Cointegration = "their relationship has gravity" (mean-reverting equilibrium). Two assets can be highly correlated yet drift apart permanently. Only cointegrated pairs‚Äîwhere the spread is statistically proven to revert‚Äîcan be traded as statistical arbitrage. As the lesson states: "Correlation measures the PAST. Cointegration predicts the FUTURE."</p>
          </div>
        </div>

        <div class="quiz-question">
          <p><strong>Q5: According to the lesson's risk management guidelines, what's the maximum position size per pair in statistical arbitrage?</strong></p>
          <div class="quiz-options">
            <div class="quiz-option" data-correct="false">A) 10-15% per pair (concentrated positions for maximum edge)</div>
            <div class="quiz-option" data-correct="true">B) 2-5% per pair (diversified across 5-10 pairs)</div>
            <div class="quiz-option" data-correct="false">C) 25-30% per pair (all-in on best setups)</div>
            <div class="quiz-option" data-correct="false">D) 0.5-1% per pair (ultra-conservative sizing)</div>
          </div>
          <div class="quiz-feedback">
            <p><strong>Correct!</strong> Never more than 2-5% per pair, using Kelly or half-Kelly criterion for sizing. You should run 5-10 pairs across different sectors to diversify. This prevents concentration risk‚Äîif one pair de-cointegrates, it won't destroy your account. Michael Torres's mistake was oversizing at 5% per pair; when he switched to 2% and diversified across multiple pairs, his execution improved dramatically.</p>
          </div>
        </div>
      </div>

      <h3 style="margin:3rem 0 1.5rem 0">Related Lessons</h3>
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(min(100%, 280px),1fr));gap:1rem;margin:1.5rem 0">
        <div class="card" style="padding:1rem">
          <span class="badge">Advanced #64</span>
          <h4 style="margin:.5rem 0 .5rem 0;font-size:1rem">Macro Regime Framework</h4>
          <p style="font-size:.9rem;color:var(--muted);margin-bottom:.75rem">Understand how regime changes affect your stat arb models.</p>
          <a href="/curriculum/advanced/64-macro-regime-framework.html" class="btn btn-sm btn-ghost">Read Lesson &rarr;</a>
        </div>
        <div class="card" style="padding:1rem">
          <span class="badge">Advanced #66</span>
          <h4 style="margin:.5rem 0 .5rem 0;font-size:1rem">Quantitative Strategy Design</h4>
          <p style="font-size:.9rem;color:var(--muted);margin-bottom:.75rem">Design and backtest quantitative statistical arbitrage strategies.</p>
          <a href="/curriculum/advanced/66-quantitative-strategy-design.html" class="btn btn-sm btn-ghost">Read Lesson &rarr;</a>
        </div>
        <div class="card" style="padding:1rem">
          <span class="badge">Advanced #67</span>
          <h4 style="margin:.5rem 0 .5rem 0;font-size:1rem">Machine Learning in Trading</h4>
          <p style="font-size:.9rem;color:var(--muted);margin-bottom:.75rem">Apply ML to enhance statistical arbitrage pair selection.</p>
          <a href="/curriculum/advanced/67-machine-learning-trading.html" class="btn btn-sm btn-ghost">Read Lesson &rarr;</a>
        </div>
      </div>

      <div class="callout-info">
        <h4>‚è≠Ô∏è Coming Up Next</h4>
        <p><strong>Lesson #64: Macro Regime Framework</strong> ‚Äî Understand how regime changes affect your stat arb models and adapt your strategies accordingly.</p>
      </div>

    </div>

    <!-- Sidebar (Navigation + Tools) -->
    <aside class="article-sidebar">
      <!-- Lesson Navigation -->
      <nav class="nav-article" aria-label="Lesson Navigation">
        <div class="nav-item prev">
          <a href="/curriculum/advanced/62-trading-career-path.html">
            <span class="nav-label">‚Üê Previous</span>
            <span class="nav-title">Trading Career Path</span>
          </a>
        </div>
        <div class="nav-item next">
          <a href="/curriculum/advanced/64-macro-regime-framework.html">
            <span class="nav-label">Next ‚Üí</span>
            <span class="nav-title">Macro Regime Framework</span>
          </a>
        </div>
      </nav>

      <!-- Action Buttons -->
      <div class="lesson-actions">
        <button id="mark-complete" class="btn btn-primary w-full">‚úì Mark as Complete</button>
        <button id="bookmark-btn" class="btn btn-ghost w-full">üîñ Bookmark</button>
      </div>

      <!-- Related Lessons -->
      <div class="card">
        <h3 style="margin:0 0 1rem 0;font-size:1rem" id="-related-lessons">üìö Related Lessons</h3>
        <ul style="list-style:none;padding:0;margin:0">
          <li style="margin-bottom:.75rem">
            <a href="/curriculum/advanced/64-macro-regime-framework.html" style="color:var(--primary);text-decoration:none">
              #64: Macro Regime Framework
            </a>
          </li>
          <li style="margin-bottom:.75rem">
            <a href="/curriculum/advanced/66-quantitative-strategy-design.html" style="color:var(--primary);text-decoration:none">
              #66: Quantitative Strategy Design
            </a>
          </li>
          <li>
            <a href="/curriculum/advanced/67-machine-learning-trading.html" style="color:var(--primary);text-decoration:none">
              #67: Machine Learning in Trading
            </a>
          </li>
        </ul>
      </div>
    </aside>
  </div>

  <div class="wrap nav-article">
  <a class="btn btn-ghost" href="/curriculum/advanced/62-trading-career-path.html">&larr; Previous Lesson</a>
  <a class="btn btn-primary" href="/curriculum/advanced/64-macro-regime-framework.html">Next Lesson &rarr;</a>
  </div>
</article>


<footer class="sp-footer"><div class="wrap"><div>¬© <span id="year"></span> Signal Pilot Labs, Inc.</div><div class="links"><a href="https://signalpilot.io/privacy.html">Privacy</a><a href="https://signalpilot.io/terms.html">Terms</a></div></div></footer>

<script src="/assets/edu.js"></script>
<script src="/assets/edu-enhanced.js"></script>
<script src="/assets/sp-bg.js"></script>
<script>
document.getElementById('year').textContent = new Date().getFullYear();
</script>
<!-- SignalPilot Theme Switcher -->
<script src="/assets/signalpilot-theme.js"></script>
<script src="/assets/spaced-repetition.js" defer></script>
<script src="/assets/chatbot.js" defer></script>
<script src="/assets/notes.js" defer></script>
<script src="/assets/analytics.js"></script>
<script src="/assets/quiz-enhanced.js"></script>
<script src="/assets/social-share.js"></script>
<script src="/assets/pwa-init.js"></script>
<script src="/assets/config.js"></script>
<script src="/assets/supabase-client.js"></script>
<script src="/assets/auth-ui.js"></script>
<script src="/assets/library.js"></script>
  <script src="/assets/lesson-rating.js" defer></script>
  <!-- Enhanced Analytics & A/B Testing -->
  <script src="/assets/enhanced-analytics.js" defer></script>
  <script src="/assets/ab-test-tldr.js" defer></script>
  <!-- Google Translate -->
  <script src="/assets/lang-switcher.js"></script>
</body>
</html>