<!doctype html>
<html lang="en" dir="ltr" data-theme="dark">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=5, viewport-fit=cover"/>
  <title>Quantitative Strategy Design: Backtesting, Optimization & Validation ‚Äî Signal Pilot</title>
  <link rel="canonical" href="https://education.signalpilot.io/curriculum/advanced/66-quantitative-strategy-design.html">
  <meta name="sp-level" content="Advanced"><meta name="sp-order" content="66">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&family=Gugi&family=Space+Grotesk:wght@300..700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/assets/signalpilot-theme.css">
  <link rel="stylesheet" href="/assets/edu.css">
  <link rel="stylesheet" href="/assets/notes.css">
  <link rel="stylesheet" href="/assets/auth-ui.css">
  <link rel="stylesheet" href="/assets/trial-cta.css">
  <link rel="stylesheet" href="/assets/blog-links.css">
  <link rel="stylesheet" href="/assets/discussions.css">
  <link rel="stylesheet" href="/assets/chatbot.css">
  <link rel="stylesheet" href="/assets/lang-switcher.css">
  <!-- Logger must load first, before other scripts that use it -->
  <script src="/assets/logger.js"></script>
  <script src="/assets/dev-utils.js" defer></script>
  <script src="/assets/notes.js" defer></script>
  <script src="/assets/library.js"></script>
  <script>window.addEventListener('load',function(){if(window.library?.isBookmarked()){var b=document.getElementById('bookmark-btn');if(b)b.innerHTML='‚≠ê Bookmarked'}})</script>
    <script src="/assets/quiz-enhanced.js" defer></script>
  <script src="/assets/social-share.js" defer></script>
  <script src="/assets/pwa-init.js"></script>
</head>
<body class="table-accordions-mobile">
<div class="bg-stars" aria-hidden="true"></div>
<canvas id="constellations" class="sp-constellations" aria-hidden="true"></canvas>
<div class="bg-aurora" aria-hidden="true"></div>
<header class="sp-header">
  <div class="wrap">
    <a href="https://signalpilot.io" class="brand">
      <span>Signal Pilot</span>
    </a>
    <nav id="mainnav" aria-label="Main"><ul>
      <li><a href="/">Education</a></li>
      <li><a href="/search.html">Search</a></li>
      <li><a href="/my-library.html">My Library</a></li>
      <li><a href="https://blog.signalpilot.io" target="_blank" rel="noopener">Blog</a></li>
    </ul></nav>
    <div class="header-ctls">
      <div id="google_translate_element"></div><button id="themeToggle" class="btn btn-ghost btn-sm" type="button" aria-label="Toggle theme">
        <span id="theme-icon">‚òΩ</span>
      </button><button id="menuToggle" class="menu-toggle" aria-expanded="false">Menu ‚ò∞</button></div>
  </div>
</header>
<article class="article">
  <header>
    <div class="wrap">
      <nav class="breadcrumb" aria-label="Breadcrumb">
        <a href="/">Home</a> <span>‚Ä∫</span>
        <a href="/advanced.html">Advanced</a> <span>‚Ä∫</span>
        <span>Lesson #66</span>
      </nav>
      <span class="badge">üî¥ Advanced ‚Ä¢ Lesson 66 of 82</span>
      <h1 class="headline xl">Quantitative Strategy Design: Building Systematic Edge</h1>
      <div class="meta">Reading time ~50-55 min ‚Ä¢ Quant Strategy Development</div>

      
      <!-- Article Progress Indicator -->
      <div class="article-progress" style="--progress:0%">
        <div class="progress-circle"><span>0%</span></div>
        <div class="progress-text">
          <strong>You're making progress!</strong>
          <div style="font-size:.85rem;color:var(--muted)">Keep reading to mark this lesson complete</div>
        </div>
      </div>
    </div>
  </header>

  <div class="wrap article-grid">
    <div class="prose">

      <div class="example-block">
        <h4>Real-World Example: Marcus's $18,400 Quantitative Strategy Disaster</h4>

        <p><strong>Background:</strong> Marcus, a former Python developer turned algorithmic trader, spent 6 months in early 2023 building what he believed was the perfect mean-reversion strategy for SPY. His backtested results looked incredible: 32% annual returns, 1.8 Sharpe ratio, only 8% maximum drawdown from 2015-2022.</p>

        <p><strong>The Strategy:</strong> Buy SPY when it closes down 1.2% or more, sell when it recovers 0.8%. He tested 10,000+ parameter combinations and found these "optimal" numbers. Excited by the results, he deployed $75,000 in live capital in March 2023.</p>

        <p><strong>The Disaster:</strong></p>
        <ul>
          <li><strong>Month 1 (March 2023):</strong> Down $4,200 (-5.6%). The market wasn't reverting like the backtest predicted.</li>
          <li><strong>Month 2 (April 2023):</strong> Down another $7,800 (-10.4% cumulative). His "1.2% down" trigger kept hitting, but recoveries took longer than 0.8%.</li>
          <li><strong>Month 3 (May 2023):</strong> Lost $6,400 more. Total loss: <strong>$18,400 in 3 months</strong> (-24.5%).</li>
        </ul>

        <p><strong>What Went Wrong:</strong> Marcus had committed every quantitative sin:</p>
        <ul>
          <li>‚ùå <strong>Curve-fitting:</strong> He optimized 1.2% and 0.8% to historical noise, not real market behavior</li>
          <li>‚ùå <strong>No out-of-sample testing:</strong> He used ALL his data to optimize (no validation set)</li>
          <li>‚ùå <strong>Ignored transaction costs:</strong> His backtest assumed perfect fills; reality had 0.03% slippage per trade destroying his thin edge</li>
          <li>‚ùå <strong>Fragile parameters:</strong> 1.1% or 1.3% thresholds completely failed‚Äîa sign of overfitting</li>
        </ul>

        <p><strong>The Recovery:</strong> After this disaster, Marcus started over using the proper methodology taught in this lesson. He redesigned with:</p>
        <ul>
          <li>‚úÖ Walk-forward validation (re-optimize every 6 months on rolling window)</li>
          <li>‚úÖ Out-of-sample testing (reserved 2022-2023 data he never touched during development)</li>
          <li>‚úÖ Realistic costs (0.05% slippage + $1 commission per trade)</li>
          <li>‚úÖ Parameter robustness testing (strategy works with 1.0-1.5% threshold range, not just 1.2%)</li>
        </ul>

        <p><strong>Results After Redesign:</strong> His new strategy had lower backtested returns (18% annual vs 32%), but it actually WORKED live. From September 2023 to February 2024, he made back $14,200 of his losses with a strategy he could trust.</p>

        <p><strong>Marcus's Lesson:</strong> "A 15% strategy that works beats a 40% backtest that fails. The key isn't finding the perfect parameters‚Äîit's building something robust enough to survive real markets."</p>
      </div>

      <p>A properly designed quantitative strategy eliminates emotion, validates edge statistically, and compounds returns systematically. This lesson teaches you how to design, backtest, and deploy institutional-grade trading systems‚Äîand avoid the $18K mistake Marcus made.</p>

      <div class="callout callout-danger">
        <h4>‚ö†Ô∏è The Overfitting Graveyard</h4>
        <p>A quant fund backtests 10,000 parameter combinations and finds a "perfect" strategy: 45% annual returns, 0.8 Sharpe ratio, 12% max drawdown from 2010-2020. They deploy $50M in January 2021.</p>
        <p>By December 2021, the fund is down 28%. The strategy was curve-fit to historical noise, not real market edge.</p>
        <p><strong>Lesson:</strong> 95% of backtested strategies fail live. This lesson shows you how to be in the 5%.</p>
      </div>

      <div style="background:rgba(118,221,255,0.08);padding:1.5rem;border-radius:8px;margin:2rem 0;border-left:4px solid var(--accent)">
        <h3 style="margin:0 0 1rem 0">üéØ What You'll Learn</h3>
        <p style="margin:0 0 0.75rem 0">By the end of this lesson, you'll be able to:</p>
        <ul style="line-height:1.8;margin:0 0 0 1.5rem">
          <li>Quant strategy: Rules-based, systematic, backtestable</li>
          <li>Components: Entry rules, exit rules, position sizing, risk management</li>
          <li>Avoid curve-fitting: Use walk-forward, out-of-sample testing, realistic assumptions</li>
          <li>Framework: Define rules ‚Üí Backtest ‚Üí Walk-forward ‚Üí Paper trade ‚Üí Live</li>
        </ul>
      </div>

      <details style="background:rgba(0,212,170,0.08);padding:1.5rem;border-radius:8px;margin:2rem 0;border-left:4px solid #00d4aa">
        <summary style="cursor:pointer;font-weight:600;font-size:1.1rem">‚ö° Quick Wins for Tomorrow (Click to expand)</summary>
        <div style="margin-top:1rem">
          <p>Don't overwhelm yourself. Start with these 3 actions:</p>
          <ol style="margin:0.75rem 0 0 1.5rem;line-height:1.8">
            <li><strong>Build Out-of-Sample Testing Framework Tonight</strong> ‚Äî Split data BEFORE optimizing: 70% training (develop strategy), 30% test (validate ONCE after finalized). Never touch test data during development. If OOS performance < 50% of in-sample ‚Üí curve-fit garbage, discard. Sarah Chen lost $142,800 deploying RSI(17) strategy: backtest 28.4% return (2015-2022), live -79.3% (2023) because she optimized on ALL data. OOS testing would've caught this. Rule: If strategy fails on unseen data, it will fail live. This prevents $140K+ curve-fitting disasters.</li>
            <li><strong>Implement Walk-Forward Optimization This Week</strong> ‚Äî Re-optimize strategy every 3-6 months on rolling window (12-month train, 6-month test). Parameters adapt to current regime instead of dying when market shifts. Michael Torres lost $97,600 with static 2010-2021 optimization: 24.7% backtest, -38.2% live (2022) when Fed hiked rates. After WFO rebuild: +18.6% (vs -38% disaster). Tonight: Set window sizes (12M train / 6M test), parameter ranges, optimization metric (Sharpe ratio recommended). This prevents $90K+ regime-shift losses.</li>
            <li><strong>Create Pre-Live Deployment Checklist (10 Gates)</strong> ‚Äî Strategy must pass ALL before risking real money: (1) OOS tested, (2) WFO validated, (3) Realistic costs modeled (slippage 0.02-0.05%), (4) Execution lag tested, (5) Multi-instrument tested (3-5 stocks), (6) Parameter robustness (¬±20% variation works), (7) Paper traded 30-60 days, (8) Max DD stress-tested, (9) Position sizing defined, (10) Kill switch set. Amanda Park lost $167,300 in 90 days: assumed $0 costs (reality: 2.5% annual drag), ignored execution lag (14.4% annual drag), only tested AAPL. After rebuild with 10 gates: +12.8% profitable. This prevents $150K-$250K deployment disasters.</li>
          </ol>
        </div>
      </details>

<h2 id="part-1-the-quantitative-strategy-development-lifecycle">Part 1: The Quantitative Strategy Development Lifecycle</h2>

  <table style="width:100%">
    <thead>
      <tr>
        <th>Phase</th>
        <th>Goal</th>
        <th>Common Pitfalls</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>1. Hypothesis</td>
        <td>Define market inefficiency to exploit</td>
        <td>Vague thesis ("buy dips works")</td>
      </tr>
      <tr>
        <td>2. Data Collection</td>
        <td>Gather clean, survivorship-bias-free data</td>
        <td>Using incomplete/biased data</td>
      </tr>
      <tr>
        <td>3. Backtesting</td>
        <td>Test hypothesis on historical data</td>
        <td>Overfitting, look-ahead bias</td>
      </tr>
      <tr>
        <td>4. Optimization</td>
        <td>Tune parameters for robustness</td>
        <td>Curve-fitting to past data</td>
      </tr>
      <tr>
        <td>5. Validation</td>
        <td>Out-of-sample testing</td>
        <td>Skipping this step entirely</td>
      </tr>
      <tr>
        <td>6. Paper Trading</td>
        <td>Live testing with fake money</td>
        <td>Ignoring execution costs</td>
      </tr>
      <tr>
        <td>7. Live Deployment</td>
        <td>Real capital, small size initially</td>
        <td>Going all-in immediately</td>
      </tr>
    </tbody>
  </table>

  <h2 id="part-2-hypothesis-development-the-foundation">Part 2: Hypothesis Development (The Foundation)</h2>

  <h3>What Makes a Good Trading Hypothesis?</h3>
  <p><strong>Requirements:</strong></p>
  <ul>
    <li><strong>Specific:</strong> "Buy when RSI &lt; 30 and price &gt; 200-day MA"</li>
    <li><strong>Testable:</strong> Can be quantified and backtested</li>
    <li><strong>Logical:</strong> Based on market behavior (not random pattern)</li>
    <li><strong>Exploitable:</strong> Edge persists long enough to profit</li>
  </ul>

  <div class="callout">
    <p><strong>üìö Example Hypotheses:</strong></p>
    <ul>
      <li><strong>Mean reversion:</strong> Stocks oversold (&lt; -2 std dev) revert to mean within 5 days</li>
      <li><strong>Momentum:</strong> Stocks breaking 52-week highs continue up for 20 days</li>
      <li><strong>Pairs trading:</strong> XLE/XLF correlation &gt; 0.8 ‚Üí trade spread mean reversion</li>
    </ul>
  </div>
<h3>Common Hypothesis Sources</h3>
  <p><strong>1. Academic research:</strong> Read papers (SSRN, Journal of Finance) ‚Üí test on current data</p>
  <p><strong>2. Market observations:</strong> Notice pattern (e.g., "tech sells off before earnings") ‚Üí quantify</p>
  <p><strong>3. Institutional strategies:</strong> Reverse-engineer dark pool prints, COT positioning</p>

  <div class="callout" style="background:rgba(251,191,36,0.1);border-left:4px solid #fbbf24;margin:2rem 0;padding:1rem">
    <h4>üí° Pro Tip: The "Market Inefficiency" Test</h4>
    <p>Before spending weeks backtesting, ask: <strong>"Why would this edge exist?"</strong></p>
    <p>Good answers:</p>
    <ul>
      <li>‚úÖ "Retail panic-sells on news, but fundamentals unchanged" (behavioral edge)</li>
      <li>‚úÖ "Market makers hedge gamma at close, creating predictable flows" (structural edge)</li>
      <li>‚úÖ "Small-cap earnings surprises take 3 days to fully price in" (inefficiency)</li>
    </ul>
    <p>Bad answers:</p>
    <ul>
      <li>‚ùå "I found this pattern in the data" (probably noise)</li>
      <li>‚ùå "RSI below 23.7 works" (arbitrary number = overfitting)</li>
    </ul>
    <p><strong>If you can't explain WHY the edge exists, it probably doesn't.</strong></p>
  </div>
<h2 id="part-3-backtesting-the-core">Part 3: Backtesting (The Core)</h2>

  <h3>Essential Backtesting Principles</h3>

  <details class="accordion">
    <summary>Principle #1: Survivorship Bias</summary>
    <div class="accordion-content">
      <p><strong>Problem:</strong> Testing only on stocks that STILL EXIST (ignores bankruptcies)</p>
      <p><strong>Example:</strong> Strategy buys distressed stocks. Backtest shows 20% annual return because it only includes survivors (GM 2008 not in dataset ‚Üí bankruptcy loss excluded)</p>
      <p><strong>Solution:</strong> Use datasets with delisted stocks (e.g., Norgate Data, Sharadar)</p>
    </div>
  </details>

  <details class="accordion">
    <summary>Principle #2: Look-Ahead Bias</summary>
    <div class="accordion-content">
      <p><strong>Problem:</strong> Using information not available at trade time</p>
      <p><strong>Example:</strong> Strategy uses "tomorrow's low" to set stop loss (impossible in real trading)</p>
      <p><strong>Another example:</strong> Using restated earnings data (not available when originally reported)</p>
      <p><strong>Solution:</strong> Ensure all signals use ONLY point-in-time data</p>
    </div>
  </details>

  <details class="accordion">
    <summary>Principle #3: Slippage & Commissions</summary>
    <div class="accordion-content">
      <p><strong>Problem:</strong> Backtests assume perfect fills at mid-price</p>
      <p><strong>Reality:</strong> You pay spread + market impact + commission</p>
      <p><strong>Example:</strong> Strategy trades 100 times/month. Without costs = +15% annual return. With $5/trade commission + 0.05% slippage = +3% return (edge destroyed)</p>
      <p><strong>Solution:</strong> Model realistic costs (0.05-0.1% per trade for liquid stocks, 0.2-0.5% for illiquid)</p>
    </div>
  </details>

  <div style="background:rgba(255,82,82,.1);border-left:4px solid #ff5252;border-radius:8px;padding:1.25rem;margin:2rem 0">
    <div style="font-weight:700;margin-bottom:0.75rem;color:#ff5252">üíÄ Sarah Chen's $142,800 Out-of-Sample Disaster (8 Months)</div>
    <div style="font-size:0.95rem;line-height:1.7">
      <strong>January-August 2023:</strong> Sarah backtested on ALL her data (2015-2022) and deployed a curve-fit RSI mean-reversion strategy on QQQ.
    </div>
    <div style="margin-top:1rem;font-size:0.9rem;line-height:1.7">
      <strong>Her strategy:</strong> After 15,000+ backtests, she found "optimal" parameters: RSI(17) < 32 ‚Üí BUY, Hold 4 days. Backtest (2015-2022): 28.4% annual return, 1.62 Sharpe.<br/>
      <strong>She deployed:</strong> $180,000 in January 2023 without out-of-sample testing.<br/>
      <strong>The disaster:</strong> Month 1: -$8,200 (-4.6%). Months 2-3: -$24,600 cumulative. Months 4-8: -$109,000 more. <span style="color:#ff5252;font-weight:700">Total loss: $142,800 (-79.3%)</span>.
    </div>
    <div style="margin-top:1rem;padding:1rem;background:rgba(0,0,0,.2);border-radius:6px;font-size:0.9rem">
      <strong>Why it failed:</strong> She optimized on 2015-2022 data, deployed on 2023 (new regime). Parameters (RSI 17, threshold 32) were curve-fit to noise. When she tested RSI(15) or RSI(19), strategy FAILED‚Äîclear overfitting. The fix: Out-of-sample testing. Split data 70% training / 30% test. NEVER touch test data until strategy finalized. If strategy works on OOS data ‚Üí might work live. If fails OOS ‚Üí curve-fit garbage. Sarah's RSI(17): In-sample 28.4%, OOS -79.3% = discard immediately.
    </div>
  </div>

  <h3>Backtest Performance Metrics</h3>

  <table style="width:100%">
    <thead>
      <tr>
        <th>Metric</th>
        <th>Formula</th>
        <th>Good Value</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>CAGR</td>
        <td>(End / Start)^(1/Years) - 1</td>
        <td>&gt; 15% (after costs)</td>
      </tr>
      <tr>
        <td>Sharpe Ratio</td>
        <td>(Return - RFR) / Std Dev</td>
        <td>&gt; 1.0 (excellent &gt; 2.0)</td>
      </tr>
      <tr>
        <td>Max Drawdown</td>
        <td>Peak-to-trough decline</td>
        <td>&lt; 20% (tolerable &lt; 30%)</td>
      </tr>
      <tr>
        <td>Win Rate</td>
        <td>Wins / Total Trades</td>
        <td>&gt; 50% (trend) or &gt; 65% (mean rev)</td>
      </tr>
      <tr>
        <td>Profit Factor</td>
        <td>Gross Profit / Gross Loss</td>
        <td>&gt; 1.5 (excellent &gt; 2.0)</td>
      </tr>
    </tbody>
  </table>

  <h2 id="part-4-optimization-the-danger-zone">Part 4: Optimization (The Danger Zone)</h2>

  <h3>The Overfitting Problem</h3>
  <p><strong>Overfitting:</strong> Strategy performs amazing on historical data but fails live (curve-fitted to noise)</p>

  <p><strong>Example of overfitting:</strong></p>
  <ul>
    <li>Test 50 different RSI thresholds (10, 15, 20, 25, 30...)</li>
    <li>Test 50 different moving averages (50-day, 100-day, 150-day...)</li>
    <li>Total combinations: 2,500 variations</li>
    <li>Find that "RSI &lt; 23.5 + 147-day MA" works best (15% annual return)</li>
    <li><strong>Problem:</strong> Those exact numbers are noise. Strategy will fail live.</li>
  </ul>

  <div class="callout">
    <p><strong>‚ö†Ô∏è Golden Rule:</strong> If a parameter change of ¬±10% destroys your strategy, it's overfit. Robust strategies work across parameter ranges (RSI 25-35 all profitable, not just RSI 30.7).</p>
  </div>

  <div class="callout" style="background:rgba(239,68,68,0.1);border-left:4px solid #ef4444;margin:2rem 0;padding:1rem">
    <h4>üö´ Red Flags: Your Strategy Is Probably Overfit If...</h4>
    <ul>
      <li>‚ùå <strong>Out-of-sample performance is <70% of in-sample</strong> (e.g., backtest 25% returns, live 12%)</li>
      <li>‚ùå <strong>Strategy only works with exact parameters</strong> (RSI 30 works, but RSI 28 or 32 fails)</li>
      <li>‚ùå <strong>You tested >100 parameter combinations</strong> before finding "the one"</li>
      <li>‚ùå <strong>Performance degrades rapidly after deployment</strong> (first month great, then crashes)</li>
      <li>‚ùå <strong>Strategy only works in one market regime</strong> (bull markets only, fails in 2022)</li>
      <li>‚ùå <strong>You can't explain WHY it works</strong> ("I just found this pattern")</li>
    </ul>
    <p><strong>If 3+ of these apply, start over with simpler rules and fewer parameters.</strong></p>
  </div>

  <div style="background:rgba(255,82,82,.1);border-left:4px solid #ff5252;border-radius:8px;padding:1.25rem;margin:2rem 0">
    <div style="font-weight:700;margin-bottom:0.75rem;color:#ff5252">üíÄ Michael Torres's $97,600 Static Optimization Disaster (14 Months)</div>
    <div style="font-size:0.95rem;line-height:1.7">
      <strong>March 2022-April 2023:</strong> Michael used a momentum breakout strategy optimized once on 2010-2021 data. Never re-optimized.
    </div>
    <div style="margin-top:1rem;font-size:0.9rem;line-height:1.7">
      <strong>His strategy:</strong> Buy SPY on 20-day highs, sell on 10-day lows. Backtest (2010-2021): 24.7% annual return. Deployed $220,000 in March 2022.<br/>
      <strong>The disaster:</strong> Fed hiked rates aggressively (0% ‚Üí 4.25%). Market regime shifted from low-vol to high-vol inflationary. Strategy got DESTROYED.<br/>
      <strong>2022 result:</strong> -38.2% (-$84,000). SPY only down -18.1%, so underperformed by 20 points. Jan-April 2023: Lost another $13,600. <span style="color:#ff5252;font-weight:700">Total: $97,600</span>.
    </div>
    <div style="margin-top:1rem;padding:1rem;background:rgba(0,0,0,.2);border-radius:6px;font-size:0.9rem">
      <strong>Why it failed:</strong> Static optimization. Optimized once on 2010-2021, never re-optimized. When regime changed in 2022, his 20-day/10-day parameters stopped working. The fix: Walk-forward optimization (WFO). Re-optimize every 3-6 months on rolling window of recent data. Parameters adapt to current market. After rebuild with rolling 6-month re-optimization: May 2023-March 2024: +18.6% (vs. -38% disaster). WFO prevents $90K+ regime-shift losses.
    </div>
  </div>

  <div style="background:rgba(139,92,246,0.05);padding:2rem;border-radius:12px;margin:2rem 0;border:2px solid rgba(139,92,246,0.2)">
    <h4 style="margin-top:0;text-align:center">üìä Overfitting Detection: 3-Test Validation</h4>
    <svg viewBox="0 0 600 620" style="width:100%;max-width:600px;margin:0 auto;display:block">
      <!-- Start Node -->
      <ellipse cx="300" cy="40" rx="120" ry="30" fill="#8b5cf6" opacity="0.2" stroke="#8b5cf6" stroke-width="2"/>
      <text x="300" y="48" text-anchor="middle" fill="currentColor" font-size="14" font-weight="bold">Backtest Complete</text>

      <!-- Arrow to Test 1 -->
      <line x1="300" y1="70" x2="300" y2="110" stroke="#8b5cf6" stroke-width="2" marker-end="url(#arrow)"/>

      <!-- Test 1 -->
      <rect x="150" y="110" width="300" height="70" rx="8" fill="#fbbf24" opacity="0.15" stroke="#fbbf24" stroke-width="2"/>
      <text x="300" y="135" text-anchor="middle" fill="currentColor" font-size="13" font-weight="600">Test 1: Out-of-Sample ‚â• 70%</text>
      <text x="300" y="155" text-anchor="middle" fill="currentColor" font-size="13" font-weight="600">of In-Sample?</text>

      <!-- YES from Test 1 -->
      <line x1="300" y1="180" x2="300" y2="220" stroke="#22c55e" stroke-width="2" marker-end="url(#arrow)"/>
      <text x="320" y="205" text-anchor="start" fill="#22c55e" font-size="12" font-weight="700">YES</text>

      <!-- NO from Test 1 -->
      <line x1="150" y1="145" x2="80" y2="145" stroke="#ef4444" stroke-width="2"/>
      <line x1="80" y1="145" x2="80" y2="540" stroke="#ef4444" stroke-width="2" marker-end="url(#arrow)"/>
      <text x="90" y="135" text-anchor="start" fill="#ef4444" font-size="12" font-weight="700">NO</text><!-- Test 2 -->
      <rect x="150" y="220" width="300" height="70" rx="8" fill="#fbbf24" opacity="0.15" stroke="#fbbf24" stroke-width="2"/>
      <text x="300" y="245" text-anchor="middle" fill="currentColor" font-size="13" font-weight="600">Test 2: ¬±10% Parameter</text>
      <text x="300" y="265" text-anchor="middle" fill="currentColor" font-size="13" font-weight="600">Changes Still Work?</text>

      <!-- YES from Test 2 -->
      <line x1="300" y1="290" x2="300" y2="330" stroke="#22c55e" stroke-width="2" marker-end="url(#arrow)"/>
      <text x="320" y="315" text-anchor="start" fill="#22c55e" font-size="12" font-weight="700">YES</text>

      <!-- NO from Test 2 -->
      <line x1="150" y1="255" x2="80" y2="255" stroke="#ef4444" stroke-width="2"/>
      <text x="90" y="245" text-anchor="start" fill="#ef4444" font-size="12" font-weight="700">NO</text>

      <!-- Test 3 -->
      <rect x="150" y="330" width="300" height="70" rx="8" fill="#fbbf24" opacity="0.15" stroke="#fbbf24" stroke-width="2"/>
      <text x="300" y="355" text-anchor="middle" fill="currentColor" font-size="13" font-weight="600">Test 3: Can You Explain</text>
      <text x="300" y="375" text-anchor="middle" fill="currentColor" font-size="13" font-weight="600">WHY Edge Exists?</text>

      <!-- YES from Test 3 to Success -->
      <line x1="300" y1="400" x2="300" y2="440" stroke="#22c55e" stroke-width="2" marker-end="url(#arrow)"/>
      <text x="320" y="425" text-anchor="start" fill="#22c55e" font-size="12" font-weight="700">YES</text>

      <!-- NO from Test 3 -->
      <line x1="150" y1="365" x2="80" y2="365" stroke="#ef4444" stroke-width="2"/>
      <text x="90" y="355" text-anchor="start" fill="#ef4444" font-size="12" font-weight="700">NO</text>

      <!-- SUCCESS BOX -->
      <rect x="180" y="440" width="240" height="70" rx="10" fill="#22c55e" opacity="0.25" stroke="#22c55e" stroke-width="3"/>
      <text x="300" y="467" text-anchor="middle" fill="#22c55e" font-size="16" font-weight="bold">‚úì ROBUST STRATEGY</text>
      <text x="300" y="490" text-anchor="middle" fill="currentColor" font-size="12">Proceed to paper trading</text>

      <!-- FAIL BOX -->
      <rect x="180" y="540" width="240" height="70" rx="10" fill="#ef4444" opacity="0.2" stroke="#ef4444" stroke-width="3"/>
      <text x="300" y="567" text-anchor="middle" fill="#ef4444" font-size="16" font-weight="bold">‚úó OVERFIT - REDESIGN</text>
      <text x="300" y="590" text-anchor="middle" fill="currentColor" font-size="11">Simplify rules, reduce parameters</text>

      <!-- Arrow markers -->
      <defs>
        <marker id="arrow" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
          <polygon points="0 0, 8 4, 0 8" fill="currentColor"/>
        </marker>
      </defs>
    </svg>
    <p style="text-align:center;margin-top:1.5rem;font-size:0.9rem;color:var(--muted)"><strong>All 3 tests must pass</strong> to validate robustness before live deployment.</p>
  </div>
<h3>Robust Optimization Techniques</h3>

  <details class="accordion">
    <summary>Technique #1: Walk-Forward Analysis</summary>
    <div class="accordion-content">
      <p><strong>Method:</strong></p>
      <ol>
        <li>Optimize on 2015-2017 data (in-sample)</li>
        <li>Test on 2018 data (out-of-sample)</li>
        <li>Re-optimize on 2016-2018 (rolling window)</li>
        <li>Test on 2019 data</li>
        <li>Repeat...</li>
      </ol>
<div class="callout-info" style="background:rgba(0,212,170,0.1);border-left:4px solid #00d4aa;margin:2rem 0">
  <p>You're now at the halfway point. You've learned the key strategies.</p>
  <p style="margin-top:0.5rem;font-size:0.9rem">Great progress! Take a quick stretch break if needed, then we'll dive into the advanced concepts ahead.</p>
</div>
      <p><strong>Pass criteria:</strong> Out-of-sample performance should be 70-90% of in-sample (not 10% or 150%)</p>
      <p><strong>Benefit:</strong> Simulates realistic adaptive strategy (re-optimizes periodically)</p>
    </div>
  </details>

  <details class="accordion">
    <summary>Technique #2: Parameter Heatmaps</summary>
    <div class="accordion-content">
      <p><strong>Method:</strong> Test all parameter combinations, visualize as heatmap</p>
      <p><strong>Example:</strong> RSI threshold (20-40) √ó MA length (100-200)</p>
      <p><strong>What to look for:</strong> "Plateau" of profitability (many parameters work), NOT single spike</p>
      <p><strong>Red flag:</strong> Only ONE combination works (overfit)</p>
      <p><strong>Green flag:</strong> 30-40% of combinations profitable (robust edge)</p>
    </div>
  </details>

  <h2 id="part-5-validation-stress-testing">Part 5: Validation & Stress Testing</h2>

  <div style="background:rgba(255,82,82,.1);border-left:4px solid #ff5252;border-radius:8px;padding:1.25rem;margin:2rem 0">
    <div style="font-weight:700;margin-bottom:0.75rem;color:#ff5252">üíÄ Amanda Park's $167,300 Pre-Deployment Disaster (90 Days)</div>
    <div style="font-size:0.95rem;line-height:1.7">
      <strong>June-August 2023:</strong> Amanda deployed a VWAP reversion strategy on AAPL without paper trading or cost validation. Lost $167,300 in first 90 days.
    </div>
    <div style="margin-top:1rem;font-size:0.9rem;line-height:1.7">
      <strong>Her strategy:</strong> Buy when price > 1.5% above VWAP, sell on reversion. Backtest (2018-2022): 19.8% annual return, 1.38 Sharpe. Deployed $280,000 June 2023.<br/>
      <strong>Disaster #1:</strong> Backtest assumed ZERO slippage + $0 commissions. Reality: $0.50/trade + 0.02% slippage. 180 trades/month = $630/month in costs (2.5% annual drag).<br/>
      <strong>Disaster #2:</strong> Backtest assumed perfect fills. Live: 5-10 second execution lag = 0.08% adverse selection √ó 180 trades = 14.4% annual drag.<br/>
      <strong>Disaster #3:</strong> Only tested on AAPL. AAPL regime shifted in 2023 (low-vol year, strategy needs high vol). 85% of signals failed.
    </div>
    <div style="margin-top:1rem;padding:1rem;background:rgba(0,0,0,.2);border-radius:6px;font-size:0.9rem">
      <strong>Total damage:</strong> Month 1: -$38,700 (-13.8%). Month 2: -$67,200 (-24%). Month 3: -$61,400 (-21.9%). <span style="color:#ff5252;font-weight:700">Cumulative: $167,300 (-59.8%)</span>. The fix: Pre-live deployment checklist. 10 gates including: OOS testing, WFO validation, realistic costs, execution lag, multi-instrument testing, parameter robustness, paper trading (30-60 days), stress testing, position sizing, kill switch. After rebuild with all 10 gates + paper trading: Sept 2024-Feb 2025: +$12,800 profit (+12.8%). This 10-gate checklist prevents $150K-$250K disasters.
    </div>
  </div>

  <h3>Out-of-Sample Testing</h3>
  <p><strong>Rule:</strong> Reserve 20-30% of data for out-of-sample testing (NEVER look at this data during development)</p>
  <p><strong>Example:</strong> Use 2010-2020 for development, 2021-2023 for final validation</p>
  <p><strong>Pass criteria:</strong> Out-of-sample Sharpe ratio ‚â• 0.7√ó in-sample Sharpe</p>

  <h3>Monte Carlo Simulation</h3>
  <p><strong>Method:</strong> Randomize trade order 10,000 times, check if max drawdown tolerable in 95% of scenarios</p>
  <p><strong>Use case:</strong> Validate that 15% max drawdown wasn't just "lucky" sequencing</p>

  <h3>Regime Testing</h3>
  <p><strong>Concept:</strong> Test strategy across different market regimes separately</p>

  <table style="width:100%">
    <thead>
      <tr>
        <th>Regime</th>
        <th>Period</th>
        <th>Expected Behavior</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Bull market</td>
        <td>2010-2019</td>
        <td>Long strategies should crush</td>
      </tr>
      <tr>
        <td>Bear market</td>
        <td>2008, 2022</td>
        <td>Long strategies should suffer (how much?)</td>
      </tr>
      <tr>
        <td>High volatility</td>
        <td>2020, 2008</td>
        <td>Mean reversion should excel</td>
      </tr>
      <tr>
        <td>Low volatility</td>
        <td>2017</td>
        <td>Momentum should excel</td>
      </tr>
    </tbody>
  </table>

  <p><strong>Red flag:</strong> Strategy only works in one regime (not robust)</p>

  <h2 id="part-6-common-strategy-types-characteristics">Part 6: Common Strategy Types & Characteristics</h2>

  <h3>Mean Reversion Strategies</h3>
  <p><strong>Hypothesis:</strong> Extreme moves revert to average</p>
  <p><strong>Typical stats:</strong> Win rate 60-70%, profit factor 1.5-2.0, max drawdown 15-25%</p>
  <p><strong>Best in:</strong> Range-bound, low-volatility markets</p>
  <p><strong>Hypothesis:</strong> Trends persist (winners keep winning)</p>
  <p><strong>Typical stats:</strong> Win rate 40-50%, profit factor 2.0-3.0+, max drawdown 20-40%</p>
  <p><strong>Best in:</strong> Trending markets, breakouts</p>
  <p><strong>Worst in:</strong> Choppy, range-bound markets (whipsaw)</p>

  <h3>Statistical Arbitrage</h3>
  <p><strong>Hypothesis:</strong> Related assets revert to equilibrium (pairs trading, correlation)</p>
  <p><strong>Typical stats:</strong> Win rate 55-65%, Sharpe 1.5-2.5, max drawdown 10-20%</p>
  <p><strong>Best in:</strong> Normal correlation regimes</p>
  <p><strong>Worst in:</strong> Correlation breakdowns (2008 = all correlations ‚Üí 1.0)</p>

  <h2 id="part-7-using-signal-pilot-for-quantitative-strategy-development">Part 7: Using Signal Pilot for Quantitative Strategy Development</h2>

  <h3>Janus Atlas: Visual Backtesting</h3>
  <p><strong>Feature:</strong> Overlay strategy signals on historical charts</p>
  <p><strong>Use case:</strong> Visually inspect entries/potential exits to catch look-ahead bias or unrealistic fills</p>

  <h3>Pentarch Pilot Line: Institutional Flow Validation</h3>
  <p><strong>Feature:</strong> Compare your strategy signals vs institutional order flow</p>
  <p><strong>Validation:</strong> If your buy signals align with institutional buying (Pilot Line) ‚Üí edge confirmed</p>

  <h3>Volume Oracle: Execution Realism Check</h3>
  <p><strong>Feature:</strong> Replay historical tape to see if your size would've filled at assumed price</p>
  <p><strong>Reality check:</strong> If strategy buys 10K shares but only 2K traded at that price ‚Üí backtest invalid</p>

  <h2 id="practice-exercise">üéØ Practice Exercise: Validate This Strategy</h2>

  <div class="callout" style="background:rgba(34,197,94,0.1);border-left:4px solid #22c55e;margin:2rem 0;padding:1.5rem">
    <h4>Scenario: Sarah's Mean Reversion Strategy</h4>

    <p><strong>Sarah shows you her backtest results and asks if she should trade it live. Here's what she tested:</strong></p>

    <p><strong>Strategy Rules:</strong></p>
    <ul>
      <li>Buy SPY when it closes down 1.5% or more from previous close</li>
      <li>Sell when SPY closes up 0.5% or more from entry, OR after 5 days (whichever comes first)</li>
      <li>Maximum 1 position at a time</li>
    </ul>

    <p><strong>Her Backtest Results (2010-2023):</strong></p>
    <table style="width:100%;margin:1rem 0">
      <thead>
        <tr>
          <th>Metric</th>
          <th>In-Sample (2010-2020)</th>
          <th>Out-of-Sample (2021-2023)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>CAGR</td>
          <td>24%</td>
          <td>22%</td>
        </tr>
        <tr>
          <td>Sharpe Ratio</td>
          <td>1.9</td>
          <td>1.7</td>
        </tr>
        <tr>
          <td>Max Drawdown</td>
          <td>12%</td>
          <td>15%</td>
        </tr>
        <tr>
          <td>Win Rate</td>
          <td>68%</td>
          <td>65%</td>
        </tr>
        <tr>
          <td>Total Trades</td>
          <td>147</td>
          <td>42</td>
        </tr>
      </tbody>
    </table>

    <p><strong>Additional Information:</strong></p>
    <ul>
      <li>She tested thresholds from 1.0% to 2.0% (in 0.1% increments)</li>
      <li>1.5% threshold had the best Sharpe ratio, but 1.3-1.7% all showed similar results</li>
      <li>She did NOT include slippage or commissions in her backtest</li>
      <li>Her broker charges $0 commissions but spread on SPY is typically $0.01 (0.0025%)</li>
      <li>She plans to trade with $50,000 capital</li>
    </ul>

    <h4 style="margin-top:1.5rem">Your Task: Answer These Questions</h4>

    <p><strong>Question 1:</strong> Is this strategy overfit? What evidence supports your answer?</p>

    <p><strong>Question 2:</strong> What's her expected REAL return after including transaction costs? Show your calculation.</p>

    <p><strong>Question 3:</strong> What are 3 specific risks she should stress-test before going live?</p>

    <p><strong>Question 4:</strong> Would you recommend she trade this live? Why or why not?</p>

    <h4 style="margin-top:2rem;border-top:1px solid rgba(34,197,94,0.3);padding-top:1rem">üìã Answer Key (Try First Before Looking!)</h4>

    <details style="margin-top:1rem">
      <summary style="cursor:pointer;font-weight:600">Click to Reveal Answers</summary>
      <div style="margin-top:1rem;padding:1rem;background:rgba(34,197,94,0.05);border-radius:8px">

        <p><strong>Answer 1: Is this strategy overfit?</strong></p>
        <p><strong>NO, this appears robust:</strong></p>
        <ul>
          <li>‚úÖ Out-of-sample performance is 92% of in-sample (22% / 24% = 92%) ‚Äî excellent! (>70% threshold)</li>
          <li>‚úÖ Parameter robustness: 1.3-1.7% all work (not just 1.5% exactly)</li>
          <li>‚úÖ Win rate dropped only 3% out-of-sample (68% ‚Üí 65%) ‚Äî stable</li>
          <li>‚úÖ Sharpe ratio out-of-sample is 89% of in-sample (1.7 / 1.9) ‚Äî very good</li>
        </ul>
        <p><strong>This passes the overfitting tests.</strong> The slight degradation in out-of-sample is normal and acceptable.</p>

        <p style="margin-top:1.5rem"><strong>Answer 2: Expected REAL return after costs?</strong></p>
        <p><strong>Calculation:</strong></p>
        <ul>
          <li>Out-of-sample CAGR: 22% (before costs)</li>
          <li>Total trades over 3 years (2021-2023): 42 trades</li>
          <li>Annual trade frequency: 42 / 3 = 14 trades/year</li>
          <li>Cost per round-trip trade: Entry spread (0.0025%) + Exit spread (0.0025%) = 0.005% per trade</li>
          <li>Annual cost drag: 14 trades √ó 0.005% = 0.07% per year</li>
        </ul>
        <p><strong>Expected real return: 22% - 0.07% ‚âà 21.93% CAGR</strong></p>
        <p>Note: Because SPY is extremely liquid and she pays no commissions, transaction costs are minimal (~7 basis points/year). The edge survives costs easily.</p>

        <p style="margin-top:1.5rem"><strong>Answer 3: Three risks to stress-test?</strong></p>
        <ol>
          <li><strong>2008-2009 crash scenario:</strong> Test on 2008 data (if not in dataset). Mean reversion strategies can get killed in sustained crashes when "dips" keep dipping.</li>
          <li><strong>March 2020 volatility spike:</strong> SPY dropped 12% in one day (March 12, 2020). Would this strategy hold through or stop out? Test max intra-day drawdown.</li>
          <li><strong>Fed policy regime change:</strong> Test 2022 separately (rising rates, QT environment). Mean reversion behaves differently when structural downtrend exists.</li>
        </ol>

        <p style="margin-top:1.5rem"><strong>Answer 4: Should she trade this live?</strong></p>
        <p><strong>YES, with conditions:</strong></p>
        <p><strong>Strengths:</strong></p>
        <ul>
          <li>‚úÖ Robust out-of-sample validation</li>
          <li>‚úÖ Transaction costs minimal (only 7 bps/year)</li>
          <li>‚úÖ Simple, explainable edge (panic selling = opportunity)</li>
          <li>‚úÖ Parameter robustness confirmed</li>
        </ul>
        <p><strong>Recommended safeguards:</strong></p>
        <ul>
          <li>üìå Start with 25% of capital ($12,500) for first 6 months to validate live performance</li>
          <li>üìå Set a "kill switch": If down >10% in first 3 months, pause and reassess</li>
          <li>üìå Add regime filter: Don't take signals if VIX >40 (extreme fear = different game)</li>
          <li>üìå Paper trade for 2-3 months first to confirm execution assumptions</li>
        </ul>
        <p><strong>Overall verdict: This is one of the better quant strategies I've seen. The validation process was done correctly, out-of-sample performance is strong, and the edge is explainable. Trade it‚Äîbut start small and monitor closely.</strong></p>
      </div>
    </details>
  </div>
<h2 id="quiz-test-your-understanding">Quiz: Test Your Understanding</h2>
  <div class="quiz">
    <div class="quiz-question">
      <p><strong>Q1:</strong> Your backtest shows 25% CAGR. Out-of-sample shows 8% CAGR. What's the problem?</p>
      <details>
        <summary>Show Answer</summary>
        <p><strong>Answer:</strong> Severe overfitting. Out-of-sample should be 70-90% of in-sample (17.5-22.5% CAGR expected). 8% = 32% of in-sample suggests strategy curve-fit to noise. Redesign with fewer parameters or simpler rules.</p>
      </details>
    </div>

    <div class="quiz-question">
      <p><strong>Q2:</strong> Strategy works with RSI &lt; 30 but fails with RSI &lt; 28 or &lt; 32. Is this robust?</p>
      <details>
        <summary>Show Answer</summary>
        <p><strong>Answer:</strong> No, this is fragile (overfit). Robust strategies work across parameter ranges. RSI 25-35 should all be profitable if edge is real. Single "magic number" (30.0) that works is red flag for curve-fitting.</p>
      </details>
    </div>

    <div class="quiz-question">
      <p><strong>Q3:</strong> Backtest ignores slippage/commissions. Returns = 12% annual. Realistic estimate after costs?</p>
      <details>
        <summary>Show Answer</summary>
        <p><strong>Answer:</strong> Depends on trade frequency. If 10 trades/year, cost ‚âà 0.5-1% total (11-11.5% net). If 100 trades/year, cost ‚âà 5-10% (2-7% net). High-frequency strategies (1000+ trades/year) often have edge destroyed by costs. Always model realistic slippage (0.05-0.1% per trade minimum).</p>
      </details>
    </div>
  </div>
<h2 id="practical-checklist">Practical Checklist</h2>
  <div class="checklist">
    <h4>Before Backtesting:</h4>
    <ul>
      <li>Write clear hypothesis (specific potential entry/potential exit rules)</li>
      <li>Obtain clean data (survivorship-bias-free, point-in-time)</li>
      <li>Define test period (minimum 10 years or 2 full market cycles)</li>
      <li>Reserve 20-30% of data for out-of-sample validation (don't peek!)</li>
    </ul>
    <h4>During Backtesting:</h4>
    <ul>
      <li>Model realistic costs: 0.05-0.1% slippage + commissions</li>
      <li>Check for look-ahead bias (are you using future data?)</li>
      <li>Limit parameter optimization (max 3-4 parameters)</li>
      <li>Test across regimes separately (bull, bear, high-vol, low-vol)</li>
    </ul><h4>After Backtesting:</h4>
    <ul>
      <li>Run out-of-sample test (must be ‚â• 70% of in-sample performance)</li>
      <li>Create parameter heatmap (check for profit plateau, not spike)</li>
      <li>Monte Carlo simulation (validate drawdown statistics)</li>
      <li>Paper trade for 3-6 months before risking real capital</li>
    </ul>
  </div><div class="key-takeaway">
    <h4>Key Takeaways</h4>
    <ul>
      <li><strong>Overfitting is the #1 killer</strong> of quant strategies (curve-fitting to noise)</li>
      <li><strong>Out-of-sample testing is mandatory</strong> (reserve 20-30% of data, never peek)</li>
      <li><strong>Robust strategies work across parameter ranges</strong> (not just one "magic number")</li>
      <li><strong>Model realistic costs:</strong> 0.05-0.1% slippage + commissions (destroys many edges)</li>
      <li><strong>Test across regimes:</strong> Strategy must survive bear markets, not just bulls</li>
    </ul>
  </div>

  <p style="font-size:1.1rem;font-weight:500;margin:2rem 0">Quantitative strategy design is systematic edge-building. Define hypothesis, backtest rigorously, optimize conservatively, and validate out-of-sample. This methodology separates profitable quant traders from overfitters.</p>

  <h3 style="margin:3rem 0 1.5rem 0">Related Lessons</h3>
  <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(min(100%, 280px),1fr));gap:1rem;margin:1.5rem 0">
    <div class="card" style="padding:1rem">
      <span class="badge">Advanced #63</span>
      <h4 style="margin:.5rem 0 .5rem 0;font-size:1rem">Statistical Arbitrage</h4>
      <p style="font-size:.9rem;color:var(--muted);margin-bottom:.75rem">Apply quant design methodology to stat arb strategies.</p>
      <a href="/curriculum/advanced/63-statistical-arbitrage.html" class="btn btn-sm btn-ghost">Read Lesson &rarr;</a>
    </div>
    <div class="card" style="padding:1rem">
      <span class="badge">Intermediate #46</span>
      <h4 style="margin:.5rem 0 .5rem 0;font-size:1rem">Advanced Risk Management</h4>
      <p style="font-size:.9rem;color:var(--muted);margin-bottom:.75rem">Implement risk management frameworks in quant strategies.</p>
      <a href="/curriculum/intermediate/46-advanced-risk-management.html" class="btn btn-sm btn-ghost">Read Lesson &rarr;</a>
    </div>
    <div class="card" style="padding:1rem">
      <span class="badge">Intermediate #47</span>
      <h4 style="margin:.5rem 0 .5rem 0;font-size:1rem">Portfolio Construction & Kelly Criterion</h4>
      <p style="font-size:.9rem;color:var(--muted);margin-bottom:.75rem">Optimize position sizing for quantitative portfolios.</p>
      <a href="/curriculum/intermediate/47-portfolio-construction-kelly.html" class="btn btn-sm btn-ghost">Read Lesson &rarr;</a>
    </div>
  </div>

  <div class="callout-info">
    <h4>‚è≠Ô∏è Coming Up Next</h4>
    <p><strong>Lesson #67: Machine Learning in Trading</strong> ‚Äî Apply ML to enhance quantitative strategies without overfitting.</p>
  </div>

  <div class="downloads">
    <h4>Downloads</h4>
    <ul>
      <li><a href="/resources/checklists/backtesting-reality-checklist.pdf" download>Backtesting Checklist (PDF)</a></li>
      <li><a href="/resources/checklists/system-development-checklist.pdf" download>Strategy Development Checklist (PDF)</a></li>
    </ul>
  </div>

  <!-- Discussion Section -->
  <div class="discussion-section" id="discussion-section">
    <button class="discussion-toggle" id="discussion-toggle" style="display:none">
      <span>üí¨ Discussion (<span id="discussion-count-mobile">0</span>)</span>
      <span class="discussion-toggle-icon">+</span>
    </button>
    <div class="discussion-content">
      <div class="discussion-header">
        <h2 class="discussion-title">üí¨ Discussion <span class="discussion-count" id="discussion-count">(0 comments)</span></h2>
        <div class="discussion-sort">
          <label for="discussion-sort">Sort by:</label>
          <select id="discussion-sort">
            <option value="recent">Most Recent</option>
            <option value="top">Top Voted</option>
            <option value="oldest">Oldest First</option>
          </select>
        </div>
      </div>
      <div class="comment-composer" id="comment-composer">
        <textarea id="comment-input" placeholder="Share your thoughts, ask questions, or discuss this lesson..." maxlength="1000"></textarea>
        <div class="comment-composer-actions">
          <span class="comment-char-count" id="comment-char-count">0/1000</span>
          <button class="btn btn-primary" id="post-comment-btn">Post Comment</button>
        </div>
      </div>
      <div class="comments-list" id="comments-list">
        <div class="comments-loading">
          <div class="comments-loading-spinner"></div>
          <p>Loading comments...</p>
        </div>
      </div>
    </div>
  </div>

      <div class="nav-article">
        <a class="btn btn-ghost" href="/curriculum/advanced/65-market-impact-models.html">‚Üê Previous Lesson</a>
        <a class="btn btn-primary" href="/curriculum/advanced/67-machine-learning-trading.html">Next Lesson ‚Üí</a>
      </div>
    </div>

    <aside class="toc-sidebar">
      <div class="lesson-actions">
        <button id="bookmark-btn" class="btn btn-secondary btn-block" onclick="window.library?.isBookmarked() ? window.library.removeBookmark() : window.library.addBookmark({title:document.title})">üîñ Bookmark</button>
        <button onclick="window.print()" class="btn btn-secondary btn-block">üìÑ Save PDF</button>
      </div>
    </aside>
  </div>
</article>
<footer class="sp-footer">
  <div class="wrap">
    <div>¬© <span id="year"></span> Signal Pilot Labs, Inc. All rights reserved.</div>
    <div class="links"><a href="https://signalpilot.io/privacy.html">Privacy</a><a href="https://signalpilot.io/terms.html">Terms</a></div>
  </div>
</footer>
<script src="/assets/edu.js"></script>
<script src="/assets/edu-enhanced.js"></script>
<script src="/assets/signalpilot-theme.js"></script>
<script>
document.getElementById('theme-toggle')?.addEventListener('click', () => {
  const html = document.documentElement;
  const currentTheme = html.getAttribute('data-theme');
  html.setAttribute('data-theme', currentTheme === 'dark' ? 'light' : 'dark');
});
const canvas = document.getElementById('constellations');
if (canvas) {
  const ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  const stars = Array.from({ length: 80 }, () => ({
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height,
    vx: (Math.random() - 0.5) * 0.2,
    vy: (Math.random() - 0.5) * 0.2
  }));
  function drawConstellations() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.strokeStyle = 'rgba(139, 92, 246, 0.15)';
    ctx.lineWidth = 1;
    for (let i = 0; i < stars.length; i++) {
      for (let j = i + 1; j < stars.length; j++) {
        const dx = stars[i].x - stars[j].x;
        const dy = stars[i].y - stars[j].y;
        const dist = Math.sqrt(dx * dx + dy * dy);
        if (dist < 150) {
          ctx.beginPath();
          ctx.moveTo(stars[i].x, stars[i].y);
          ctx.lineTo(stars[j].x, stars[j].y);
          ctx.stroke();
        }
      }
      stars[i].x += stars[i].vx;
      stars[i].y += stars[i].vy;
      if (stars[i].x < 0 || stars[i].x > canvas.width) stars[i].vx *= -1;
      if (stars[i].y < 0 || stars[i].y > canvas.height) stars[i].vy *= -1;
    }
    requestAnimationFrame(drawConstellations);
  }
  drawConstellations();
  window.addEventListener('resize', () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  });
}
</script>
<script src="/assets/config.js"></script>
<script src="/assets/supabase-client.js"></script>
<script src="/assets/auth-ui.js"></script>
  <script src="/assets/chatbot.js" defer></script>
  <!-- Enhanced Analytics & A/B Testing -->
  <script src="/assets/enhanced-analytics.js" defer></script>
  <script src="/assets/ab-test-tldr.js" defer></script>
  <!-- Google Translate -->
  <script src="/assets/lang-switcher.js"></script>
  <!-- Discussion System -->
    <script src="/assets/trial-cta.js"></script>
  <script src="/assets/blog-links.js"></script>
  <script src="/assets/discussions.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      if (window.DiscussionSystem) {
        window.DiscussionSystem.init('advanced-66-quantitative-strategy-design');
      }
    });
  </script>
</body>
</html>